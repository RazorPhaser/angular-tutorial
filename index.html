<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Up and Running with Angular Workshop</title>


	<meta charset="utf-8">
	<meta name="description" content="Up and Running with Angular Workshop">
	<meta name="author" content="Justin James">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="css/style.css" rel="stylesheet">
</head>

<body>

	<div id="container">
		<div id="header">
			<a href="#" class="menu header-btn" id="toggle-toc"></a>
			<h1>Up and Running with Angular Workshop</h1>
			<a href="https://github.com/digitaldrummerj/angular-tutorial" class="github header-btn"></a>
		</div>
		<div id="content-container">
			<div id="toc">
				<div class="toc-heading">Table of Contents</div>
				<div id="toc-padding"></div>
			</div>
			<div id="book">
				<div class="chapter">
					<h2 id="overview">Overview</h2>
<p>Welcome to the Up and Running with Angular Workshop.  Angular 2 was released in September 2016 and was a full re-write of the framework.  With the re-write a lot has changed.   In this workshop, you will learn how to build an Angular UI from the ground up.  </p>
<div class="alert alert-danger" role="alert">This workshop has been written for and tested with Angular 4.1</div>

<h3 id="new-naming-convention">New Naming Convention</h3>
<p>The first thing is what to call Angular.  Angular 1 is now referred to as AngularJS.  Angular 2 and above is referred to as just Angular.  From here on out, we will just call it Angular.  The only time to refer to Angular with a version number is when you are talking about a feature that it specific to that version.  For example, in Angular 4, they add the TitleCase Pipe and an email validator.</p>
<h3 id="release-schedule">Release Schedule</h3>
<p>The second thing is that they are now following SemVer for the versioning of Angular and have a release schedule.  For example, here is how version 2.3.1 would break down.</p>
<p><img src="images/semver.png" alt="SemVer"></p>
<p>Release Schedule:</p>
<ul>
<li>Major: Every 6 months</li>
<li>Minor: Every month</li>
<li>Patch: Every week</li>
</ul>
<h3 id="coming-from-angular-1">Coming from Angular 1</h3>
<p>Third, if you are coming from an Angular 1 background, it is best if you do not try to compare the concepts between Angular 1 and Angular 2+.  You will be able to learn Angular Just treat Angular 2 as a whole new framework  </p>
<h3 id="materials">Materials</h3>
<p><a href="https://github.com/digitaldrummerj/angular2-tutorial/tree/code">Completed Source Code</a></p>

				</div>
				<hr>
				<div class="chapter">
					<h2 id="getting-up-and-running">Getting up and running</h2>
<h3 id="overview">Overview</h3>
<p>To get started, we need to install and configure the following software first.</p>
<ul>
<li>Windows, Mac, or Linux computer</li>
<li>Visual Studio Code (can use any text editor but workshop tested with Visual Studio Code)</li>
<li>Node 6.9+</li>
<li>Angular CLI 1.0.0+</li>
</ul>
<h3 id="goals">Goals</h3>
<ul>
<li>Undersstand how to install the Angular Command Line (CLI)</li>
<li>Setup your machine for the Workshop</li>
</ul>
<h3 id="windows-showing-file-extensions">Windows Showing File Extensions</h3>
<div class="alert alert-danger" role="alert">
<strong>Windows Only</strong> 
</div>

<p><strong>Non-Windows users can <a href="#chapter2.2">skip to next section</a></strong></p>
<p>By default Windows is set to not show file extensions for known files which causes files such as .gitconfig and .npmrc to show up as just a period with no file extension which makes it extremely difficult to figure out what the file actually is.  To fix this we need to turn set Windows Explorer to show file extensions.</p>
<h4 class="exercise-start">
    <b>Exercise</b>: Turn On Windows Showing File Extensions
  </h4>


<ol>
<li>Open Windows Explorer</li>
<li><p>Click on the View Tab and select Options</p>
<p> <img src="images/chapter1/windows-explorer-ribbon.png" style="height:147px;width:759px;margin-left: 10px"></p>
</li>
</ol>
<p>Once the &quot;Folder Options&quot; dialog is open: </p>
<ol>
<li>Click on the View Tab</li>
<li>Uncheck the &quot;Hide extensions for known file types&quot;</li>
<li><p>Click Ok</p>
<p> <img src="images/chapter1/windows-explorer-view-options.png" style="height:475px;width:382px;margin-left: 10px"></p>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="visual-studio-code">Visual Studio Code</h3>
<p>Visual Studio Code is Microsoft lightweight cross platform IDE.  </p>
<ol>
<li>Download Visual Studio Code at <a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></li>
<li>Once the download finishes, launch the installer except all of the defaults.</li>
</ol>
<h3 id="node-js">Node.js</h3>
<p>NodeJS is used to power the Angular CLI as well as install all of our dependencies.  The Angular CLI requires Node version 6.9 or greater.</p>
<ol>
<li>Download the latest stable version (LTS) of <a href="http://nodejs.org">NodeJS</a> which as of this writing is 6.10.2.    </li>
<li>Run the installer and accept all defaults.</li>
<li><p>Verify that Node installed.  Start a command prompt or terminal window and run: </p>
<pre><code class="lang-bash"> node -v
</code></pre>
</li>
</ol>
<h3 id="angular-cli-install">Angular CLI Install</h3>
<p>The Angular CLI (Command Line Interface) makes it so that you do not have to worry about the Angular tooling and can focus instead on your code. You can create new projects, components, modules, services, guards, pipes and routes.  As well it has commands for linting, testing and running our code.  </p>
<p>All of the code that is generated by the Angular CLI following the Angular Style Guide.  </p>
<p>While you do not have to use the Angular CLI, it is highly recommended, will increase your productivity, and this workshop only gives the instructions for developing with the Angular CLI.  </p>
<h4 class="exercise-start">
    <b>Exercise</b>: Install Angular CLI
</h4>

<ol>
<li><p>Open a command prompt or terminal and run the following command</p>
<pre><code class="lang-bash"> npm install -g @angular/cli
</code></pre>
</li>
<li><p>Verify Angular CLI</p>
<pre><code> ng --version
</code></pre><p> <img src="images/chapter1/ng-version.png" alt="ng version output"></p>
</li>
</ol>
<div class="exercise-end"></div>

				</div>
				<hr>
				<div class="chapter">
					<h2 id="create-new-project">Create New Project</h2>
<h3 id="overview">Overview</h3>
<h3 id="goals">Goals</h3>
<ul>
<li>Understand how to create a new project</li>
<li>Understand how to find help for an Angular CLI command</li>
<li>Understand the project layout</li>
<li>Understand how to run the project</li>
</ul>
<h3 id="generate-new-project">Generate New Project</h3>
<p>The project that the Angular CLI create for you follows all of the suggested standards and has webpack for bundling built-in to it.    </p>
<h4 class="exercise-start">
    <b>Exercise</b>: Create Angular Project
</h4>

<ol>
<li>Open a command prompt</li>
<li><p>Navigate to where you want to store your project files.  I use c:\projects on Windows and ~/projects on OSx.  You are free to use anywhere that you want. </p>
<ul>
<li><p>Windows:</p>
<pre><code class="lang-bash">  cd \
</code></pre>
</li>
<li><p>OSx:</p>
<pre><code class="lang-bash">  cd ~/
</code></pre>
</li>
</ul>
</li>
<li><p>Create the projects directory.  If you already have a directory that you store your projects in then you can skip this step.</p>
<pre><code class="lang-bash"> mkdir projects
</code></pre>
</li>
<li><p>Navigate into the projects directory</p>
<pre><code class="lang-bash"> cd projects
</code></pre>
</li>
<li><p>Generate a project named ngws that uses scss for styling and includes a routing file by running</p>
<pre><code class="lang-bash"> ng new ngws --style scss --routing
</code></pre>
</li>
<li><p>If you want to see the other ng new options or any Angular CLI command append the --help</p>
<pre><code class="lang-bash"> ng new --help
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>


<h3 id="opening-project-in-visual-studio-code">Opening Project in Visual Studio Code</h3>
<ol>
<li>Open Visual Studio Code</li>
<li>Click File -&gt; Open Folder...</li>
<li>Navigate to angular-tutorial directory and click Select Folder </li>
<li><p>Your project should now be opened in Visual Studio Code</p>
<p> <img src="images/project-layout.png" alt="Project Layout"></p>
</li>
</ol>
<h3 id="running-project">Running Project</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Run the project
</h4>

<p>The Angular CLI has a built-in command for starting up a web server for your project called <code>ng serve</code> which will run webpack to bundle up your code, start the web server, rebuild on file changes (watch) and refresh connected browsers (live reload).</p>
<ol>
<li>Visual Studio Code has a built-in terminal that we can use to run our commands.  On Windows, this is a powershell prompt.  To open the Integrated Terminal go under the View Menu and click on the Integrate Terminal or press Ctrl+`<ul>
<li>You are free to use the regular command prompt outside of Visual Studio Code if you would like</li>
</ul>
</li>
<li><p>Run</p>
<pre><code class="lang-bash"> ng serve
</code></pre>
<p> <img src="images/ng-serve.png" alt="ng serve output"></p>
</li>
</ol>
<ol>
<li><p>If you launch your browser and navigate to <a href="http://localhost:4200">http://localhost:4200</a>, you will see a page that looks like</p>
<p> <img src="images/appworks.png" alt="app works"></p>
</li>
</ol>
<div class="exercise-end"></div>


<h3 id="review">Review</h3>
<p>In this chapter we learned 3 things</p>
<ol>
<li>How to create a new projects using the <code>ng new</code> command</li>
<li>What the project layout looks like for an Angular project generated with the CLI</li>
<li>How to run our project with the <code>ng serve</code> command and view it at <a href="http://localhost:4200">http://localhost:4200</a></li>
</ol>

				</div>

				<hr>
				<div class="chapter">
					<h2 id="bootstrap">Bootstrap</h2>
<h3 id="overview">Overview</h3>
<p>For our styling we are going to use <a href="https://v4-alpha.getbootstrap.com/">Bootstrap 4</a> which is still in alpha.  The reason for picking Bootstrap 4 and not Bootstrap 3 is so that you will be able to use the <a href="https://ng-bootstrap.github.io">Angular UI library</a> if you so choose.  We will not be using the Angular UI library in this workshop but it is a great library for component.  If you are a Bootstrap 3 developer, you can see all of the change in the <a href="https://v4-alpha.getbootstrap.com/migration/">Migration Guide</a>. </p>
<h3 id="goals">Goals</h3>
<ul>
<li>Understand how to include Bootstrap 4 into your project</li>
</ul>
<h3 id="install-bootstrap">Install Bootstrap</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Install Bootstrap
</h4>

<pre><code class="lang-bash"> npm install --save bootstrap@next font-awesome
</code></pre>
<div class="exercise-end"></div>

<h3 id="add-bootstrap-to-project">Add Bootstrap to Project</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Add  Bootstrap to Project
</h4>

<p>First we need to create our own custom Bootstrap style sheet so that we can override the scss variables if we want to with your own colors and styles.</p>
<ol>
<li>In the src\assets folder, create a new folder named bootstrap</li>
<li>In the bootstrap folder, create a file called _variables.scss</li>
<li><p>Add the following to the _variables.scss file</p>
<pre><code class="lang-scss"> // Variables
 // Colors
 //
 // Grayscale and brand colors for use across Bootstrap.
 $dark-blue: #003C71;

 // Start with assigning color names to specific hex values.
 $white:  #fff !default;
 $black:  #000 !default;
 $red:    #d9534f !default;
 $orange: #f0ad4e !default;
 $yellow: #ffd500 !default;
 $green:  #5cb85c !default;
 $blue:   #0275d8 !default;
 $teal:   #5bc0de !default;
 $pink:   #ff5b77 !default;
 $purple: #613d7c !default;

 // Create grayscale
 $gray-dark:                 #292b2c !default;
 $gray:                      #464a4c !default;
 $gray-light:                #636c72 !default;
 $gray-lighter:              #eceeef !default;
 $gray-lightest:             #f7f7f9 !default;

 // Reassign color vars to semantic color scheme
 $brand-primary:             $blue !default;
 $brand-success:             $green !default;
 $brand-info:                $teal !default;
 $brand-warning:             $orange !default;
 $brand-danger:              $red !default;
 $brand-inverse:             $gray-dark !default;
</code></pre>
</li>
<li><p>In the bootstrap folder, create a file called bootstrap.scss</p>
</li>
<li><p>Add the following contents to the bootstrap.scss file. Note that the list of included files outside of the variables file is the same as the ones in the  node_modules\bootstrap\scss\bootstrap.scss file with a ~bootstrap/scss prefix so that the scss compiler is able to find the included file in the node_modules\bootstrap\scss directory.</p>
<pre><code class="lang-scss"> @import &quot;variables&quot;;

 @import &quot;~bootstrap/scss/variables&quot;;
 @import &quot;~bootstrap/scss/mixins&quot;;
 @import &quot;~bootstrap/scss/custom&quot;;

 // Reset and dependencies
 @import &quot;~bootstrap/scss/normalize&quot;;
 @import &quot;~bootstrap/scss/print&quot;;

 // Core CSS
 @import &quot;~bootstrap/scss/reboot&quot;;   
 @import &quot;~bootstrap/scss/type&quot;;
 @import &quot;~bootstrap/scss/images&quot;;
 @import &quot;~bootstrap/scss/code&quot;;
 @import &quot;~bootstrap/scss/grid&quot;;
 @import &quot;~bootstrap/scss/tables&quot;;
 @import &quot;~bootstrap/scss/forms&quot;;
 @import &quot;~bootstrap/scss/buttons&quot;;

 // Components
 @import &quot;~bootstrap/scss/transitions&quot;;
 @import &quot;~bootstrap/scss/dropdown&quot;;
 @import &quot;~bootstrap/scss/button-group&quot;;
 @import &quot;~bootstrap/scss/input-group&quot;;
 @import &quot;~bootstrap/scss/custom-forms&quot;;
 @import &quot;~bootstrap/scss/nav&quot;;
 @import &quot;~bootstrap/scss/navbar&quot;;
 @import &quot;~bootstrap/scss/card&quot;;
 @import &quot;~bootstrap/scss/breadcrumb&quot;;
 @import &quot;~bootstrap/scss/pagination&quot;;
 @import &quot;~bootstrap/scss/badge&quot;;
 @import &quot;~bootstrap/scss/jumbotron&quot;;
 @import &quot;~bootstrap/scss/alert&quot;;
 @import &quot;~bootstrap/scss/progress&quot;;
 @import &quot;~bootstrap/scss/media&quot;;
 @import &quot;~bootstrap/scss/list-group&quot;;
 @import &quot;~bootstrap/scss/responsive-embed&quot;;
 @import &quot;~bootstrap/scss/close&quot;;

 // Components w/ JavaScript
 @import &quot;~bootstrap/scss/modal&quot;;
 @import &quot;~bootstrap/scss/tooltip&quot;;
 @import &quot;~bootstrap/scss/popover&quot;;
 @import &quot;~bootstrap/scss/carousel&quot;;

 // Utility classes
 @import &quot;~bootstrap/scss/utilities&quot;;

 /*
 * Font Awesome 4.x
 */
 $fa-font-path: &quot;~font-awesome/fonts&quot;;
 @import &quot;~font-awesome/scss/font-awesome&quot;;
</code></pre>
</li>
</ol>
<p>Now we need to configure the angular cli to import the bootstrap libraries.  </p>
<ol>
<li>Open the .angular-cli.json file which is the configuration file for our project for the Angular CLI </li>
<li><p>Find the apps\styles section and replace the section with:  </p>
<pre><code class="lang-TypeScript">   &quot;styles&quot;: [
     &quot;assets/bootstrap/bootstrap.scss&quot;,
      &quot;styles.scss&quot;
   ],
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="add-banner-section-to-top">Add Banner Section to Top</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Add Banner To Top of Page
</h4>

<ol>
<li><p>Open the src\app\app.compoment.html file and replace the contents with:</p>
<pre><code class="lang-html"> &lt;div class=&quot;jumbotron&quot;&gt;
     &lt;div class=&quot;container&quot;&gt;
         &lt;h1&gt;{{title}}&lt;/h1&gt;
     &lt;/div&gt;
 &lt;/div&gt;
 &lt;div class=&quot;container&quot;&gt;
     &lt;router-outlet&gt;&lt;/router-outlet&gt;
 &lt;/div&gt;
</code></pre>
</li>
<li><p>Lets change the title to something better than &quot;App Works!&quot;</p>
<ul>
<li>Open the src\app\app.component.ts file</li>
<li><p>On line 9, change the title variable to</p>
<pre><code class="lang-TypeScript">  title = &#39;Our Awesome Todo App!&#39;;
</code></pre>
</li>
</ul>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="view-changes">View Changes</h3>
<p>Normally, we would just be able to use the live reload feature of the ng serve command but since we changed the Angular CLI configuration file (.angulal-cli.json), we have to restart the ng serve command for the changes to take effect.  </p>
<h4 class="exercise-start">
    <b>Exercise</b>: Restart ng serve
</h4>

<ol>
<li>Go to the terminal that is running the <code>ng serve</code> command and do a ctrl+c to stop it.</li>
<li><p>Run the <code>ng serve</code> command again.</p>
<pre><code class="lang-bash"> ng serve
</code></pre>
</li>
<li><p>The web page should now look like</p>
<p> <img src="images/bootstrap-jumbotron.png" alt="App Works with Bootstrap"></p>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="review">Review</h3>
<p>In this chapter we learned how to use Bootstrap for our project.  </p>
<p>Learned:</p>
<ol>
<li>How to install Bootstrap 4 and font-awesome</li>
<li>How to integrate it into the Angular CLI in the .angular-cli.json file</li>
<li>How to create our own custom Bootstrap SCSS variables to override the built-in styles of Bootstrap with our own colors</li>
<li>How to create a banner at the top of the page</li>
<li>How to change the text that appears in the banner using our TypeScript title variable</li>
<li>Learned that when you modify the .angular-cli.json file that you have to restart <code>ng serve</code> for the changes to take effect</li>
</ol>

				</div>
				<hr>
				<div class="chapter">
					<h2 id="header-and-footer">Header and footer</h2>
<h3 id="overview">Overview</h3>
<p>In most web sites we have a header and footer at the top and bottom of the page respectively with our logo, navigation, and important links.  The header will contain our logo and navigation menu while the footer will contain our copyright info. </p>
<h3 id="goals">Goals</h3>
<ul>
<li>Understand how to create a new component</li>
<li>Understand how to include components inside of other components</li>
<li>Understand how to utilize Bootstrap </li>
</ul>
<h3 id="create-header-component">Create Header Component</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Creating the header component
</h4>

<p>We can leave ng serve running while we make these changes and open up another Integrate Terminal for the commands below.</p>
<ol>
<li>In the VS Code Integrated Terminal, click the + to open a 2nd terminal</li>
<li><p>Run the ng generate command to create the header component</p>
<pre><code class="lang-bash"> ng generate component shared/header
</code></pre>
</li>
<li><p>The generate command will create 4 files: </p>
<p> <img src="images/header-generate.png" alt="output of generate"></p>
<ul>
<li>scss (styles)</li>
<li>html (view)</li>
<li>spec file (test)</li>
<li>component (controller)</li>
<li>add reference to the component in the app.module.ts file.</li>
</ul>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Add the Menu 
</h4>

<div class="alert alert-warning" role="alert">This is a sample menu that includes a few links and a sub-menu dropdown.  Note that none of the links will work since we have not created any of those other pages or routes.</div>

<ol>
<li><p>Open the src\app\shared\header.component.html file and replace the contents with the following. </p>
<pre><code class="lang-html"> &lt;header&gt;
     &lt;nav class=&quot;navbar navbar-toggleable-md navbar-light bg-faded&quot;&gt;
         &lt;button class=&quot;navbar-toggler navbar-toggler-right&quot; type=&quot;button&quot; data-toggle=&quot;collapse&quot; data-target=&quot;#navbarSupportedContent&quot;
         aria-controls=&quot;navbarSupportedContent&quot; aria-expanded=&quot;false&quot; aria-label=&quot;Toggle navigation&quot;&gt;
         &lt;span class=&quot;navbar-toggler-icon&quot;&gt;&lt;/span&gt;
     &lt;/button&gt;
         &lt;a class=&quot;navbar-brand&quot; [routerLink]=&quot;[&#39;/&#39;]&quot;&gt;&lt;img class=&quot;navbar-logo&quot; src=&quot;./assets/todo_logo.png&quot; alt=&quot;Logo&quot;&gt;&lt;/a&gt;
         &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;navbarSupportedContent&quot;&gt;
         &lt;ul class=&quot;nav navbar-nav mr-auto&quot;&gt;
             &lt;li class=&quot;nav-item active&quot;&gt;
             &lt;a class=&quot;nav-link&quot; [routerLink]=&quot;[&#39;/&#39;]&quot;&gt;All Items&lt;/a&gt;
             &lt;/li&gt;
         &lt;/ul&gt;
         &lt;/div&gt;
     &lt;/nav&gt;
 &lt;/header&gt;
</code></pre>
</li>
<li><p>Right-click on the logo below and save it to the src/assets folder of our project</p>
<p> <img src="images/todo_logo.png" alt="Logo"></p>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="display-header">Display Header</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Update Main page
</h4>

<p>Now that we have created the menu, we need to add it to our rendered view.  </p>
<ol>
<li>Open the src\app\app.component.ts file </li>
<li><p>Import the header component.  Add the import statement on line 2 right below the existing import statement.</p>
<pre><code class="lang-TypeScript"> import { HeaderComponent } from &#39;./shared/header/header.component&#39;;
</code></pre>
</li>
<li><p>Open the src\app\app.component.html file and replace the contents of this file with the following html.  </p>
<pre><code class="lang-html"> &lt;app-header&gt;&lt;/app-header&gt;
 &lt;div class=&quot;jumbotron&quot;&gt;
     &lt;div class=&quot;container&quot;&gt;
         &lt;h1&gt;{{title}}&lt;/h1&gt;
     &lt;/div&gt;
 &lt;/div&gt;
 &lt;div class=&quot;container clearfix&quot;&gt;
     &lt;router-outlet&gt;&lt;/router-outlet&gt;
 &lt;/div&gt;
</code></pre>
 <div class="alert alert-info" role="alert"><strong>Note:</strong> that the router-outlet tag is how Angular knows where to put the content of each of the views.</div>
</li>
<li><p>If you view the web page you should see the header with logo, &quot;All Items&quot; menu and our banner.</p>
<p><img src="images/header-view.png" alt="App Component with Header View"></p>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="create-footer">Create Footer</h3>
<p>Creating the footer is very similar to creating the header.  The biggest difference is that we have some css styling that we will apply to position the footer at the bottom of the page.  </p>
<p>The really awesome part of the css we are going to apply is that Angular has the concept of CSS encapsulation so the styling will only apply to the footer component and not to the rest of the site.  This gets automatically implemented for us, just by putting the styling in the footer components scss file instead of using th global style.scss file.</p>
<h4 class="exercise-start">
    <b>Exercise</b>: Creating the footer component
</h4>


<ol>
<li><p>In the Integrated Terminal, run the ng generate command to create the header component</p>
<pre><code class="lang-bash"> ng generate component shared/footer
</code></pre>
</li>
<li><p>The generate command will create 4 files: </p>
<p> <img src="images/footer-generate.png" alt="Generate Output"></p>
<ul>
<li>scss (styles)</li>
<li>html (view)</li>
<li>spec file (test)</li>
<li>component (controller)</li>
<li>add reference to the component in the app.module.ts file.</li>
</ul>
</li>
<li><p>Open the src\app\shared\footer\footer.component.html and replace the contents with</p>
<pre><code> &lt;footer&gt;
     &lt;div class=&quot;pull-center&quot;&gt;
         &amp;copy;Angular WS
     &lt;/div&gt;
 &lt;/footer&gt;
</code></pre></li>
</ol>
<div class="exercise-end"></div>    

<h4 class="exercise-start">
    <b>Exercise</b>: Styling the Footer
</h4>

<p>We want to postion the footer at bottom of the page and change the background color.  With Angular 2, we now have the ablity to have css constrained to an individual component like the footer instead of being global for the whole site to use.  We still have the ability to have global css for those styles that should be applied to the whole site by using the src\styles.scss file.  </p>
<p>Since the footer is in the src\app\shared\footer\footer.component.html file we need to add the footer styles to the src\app\footer\footer.component.scss file and add the following content</p>
<pre><code class="lang-scss">@import &quot;../../../assets/bootstrap/variables.scss&quot;;

footer {
    position: fixed;
    height: 50px;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 10px 5px;
    border-top: 1px solid $gray-light;
    background-color: $gray-lighter;
    font-size: 0.8em;
    color: $dark-blue;
    div {
        margin-left: 25px;
        margin-right: 25px;
    }
}
</code></pre>
<div class="exercise-end"></div>

<h3 id="display-footer">Display Footer</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Update Main page
</h4>

<p>Now we are ready to add our footer to the Main page</p>
<ol>
<li><p>Open the src\app\app.component.ts file and import the footer component below the HeaderComponent import statement (note: order is not important)</p>
<pre><code class="lang-TypeScript">import { FooterComponent } from &#39;./shared/footer/footer.component&#39;;
</code></pre>
</li>
<li><p>Open the src\app\app.component.html file and replace the contents of this file with the following html</p>
<pre><code class="lang-html"> &lt;app-header&gt;&lt;/app-header&gt;
 &lt;div class=&quot;jumbotron&quot;&gt;
     &lt;div class=&quot;container&quot;&gt;
         &lt;h1&gt;{{title}}&lt;/h1&gt;
     &lt;/div&gt;
 &lt;/div&gt;
 &lt;div class=&quot;container clearfix&quot;&gt;
     &lt;router-outlet&gt;&lt;/router-outlet&gt;
 &lt;/div&gt;
 &lt;app-footer&gt;&lt;/app-footer&gt;
</code></pre>
</li>
<li><p>If you view the web page you should see the footer </p>
<p><img src="images/footer-view.png" alt="App Works with Footer"></p>
</li>
</ol>
<div class="exercise-end"></div>


<h4 class="exercise-start">
    <b>Exercise</b>: Fixing body height
</h4>

<p>Since we have a static footer, will need to change the body height to account for the footer height.  Without doing this the body content will be hidden for the last 50px of the screen.</p>
<p>So far we have seen how to use component level css but Angular still has the ability to do global styles that will apply to the whole by adding them into the src\style.scss file.</p>
<ol>
<li><p>Open the src\style.scss file and add the following css </p>
<pre><code class="lang-html"> html {
     position: relative;
     height: auto;
     min-height: 100%;
 }

 body {
     position: static;
     height: auto;
     margin: 0 0 60px; /* bottom = footer height */
 }
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="review">Review</h3>
<p>In this chapter will learned:</p>
<ol>
<li>How to create new components</li>
<li>How to import and use components within other components</li>
<li>Learned about component level styles so that they only apply to a single component</li>
<li>Learned how to do global styles that apply to the whole site</li>
<li>Learned that if we have a static footer that we need to adjust the body margin height to stop content for being hidden behind the footer.</li>
<li>Learned that the <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code> tag is used to tell Angular the location within the html code to render the routed component&#39;s template (html)</li>
</ol>

				</div>
				<hr>

				<div class="chapter">
					<h2 id="template-based-forms">Template Based Forms</h2>
<h3 id="overview">Overview</h3>
<p>There are 2 options for creating forms within Angular: Template based and Model based.  This chapter will cover template based forms.</p>
<p>Template based forms are simple and easy to use.  They are great for simple use cases.  However, there are some limitations with template  based forms: 1.) You end up with a lot of logic in your html code 2.) Cross field validation is more difficult 3.) You can not unit test your form and validation logic.</p>
<p>To demonstrate template based forms, we are going to be build a login component.</p>
<h3 id="goals">Goals</h3>
<ul>
<li>Understand template based forms</li>
<li>Create template based form</li>
<li>Implement input validation</li>
<li>Submit form values to a service</li>
</ul>
<h3 id="create-login-component">Create Login Component</h3>
<p>The first thing we need to do is to create our login component using the Angular CLI.  We will use the <code>ng generate component</code> command to do this.  </p>
<h4 class="exercise-start">
    <b>Exercise</b>: Create Login  Component 
</h4>

<ol>
<li>Within VS Code, open up the integrated terminal (ctrl+`) or view menu and then &quot;Integrated Terminal&quot;</li>
<li><p>Run the ng generate command below to create the login component</p>
<pre><code class="lang-bash"> ng generate component login
</code></pre>
</li>
<li><p>The generate command will create 4 files: </p>
<p> <img src="images/login-generate.png" alt="output of generate"></p>
<ul>
<li>scss (styles)</li>
<li>html (view)</li>
<li>spec file (test)</li>
<li>component (controller)</li>
<li>add reference to the component in the app.module.ts file.</li>
</ul>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="add-route">Add Route</h3>
<p>In order to view our Login component we need to tell Angular how to route to it.  We are going to add a route at &#39;/login&#39; to the LoginComponent.</p>
<h4 class="exercise-start">
    <b>Exercise</b>: Login Routing 
</h4>

<p>Before we can view our Login component, we need to tell Angular how to route to the component</p>
<ol>
<li>Open the src\app\app-routing.module.ts file</li>
<li><p>Add the Import statement for the login component on line 3</p>
<pre><code class="lang-TypeScript"> import { LoginComponent } from &#39;./login/login.component&#39;;
</code></pre>
</li>
<li><p>Add the LoginComponent route to the list of routes+</p>
<pre><code class="lang-TypeScript"> { path: &#39;login&#39;, children: [], component: LoginComponent }
</code></pre>
 <div class="alert alert-info" role="alert"><strong>Note:</strong> This will cause the LoginComponent to load into the <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code> in the src\app\app.component.html when navigate to <a href="http://localhost:4200/login">http://localhost:4200/login</a> .  The router-outlet tag is how Angular knows where to put the rendered content of the routed componente.</div>


</li>
</ol>
<ol>
<li><p>The Login page should be able to be displayed if you navigate to <a href="http://localhost:4200/login">http://localhost:4200/login</a></p>
<p> <img src="images/login-initial-view.png" alt="login initial view"></p>
</li>
</ol>
<div class="exercise-end"></div>


<h3 id="create-form">Create Form</h3>
<p>Next we are going to create the form without any validation logic at all.  Our form will have 2 input fields:  email and password and 2 buttons: submit and cancel.  </p>
<h4 class="exercise-start">
    <b>Exercise</b>:  Creating the Form
</h4>

<ol>
<li>Open src\app\login\login.component.html</li>
<li><p>Replace the existing html with the following</p>
<pre><code class="lang-html"> &lt;h1&gt;Login&lt;/h1&gt;
 &lt;hr&gt;
 &lt;div&gt;
     &lt;form autocomplete=&quot;off&quot; novalidate&gt;
         &lt;div class=&quot;form-group&quot;&gt;
             &lt;label for=&quot;email&quot;&gt;Email:&lt;/label&gt;
             &lt;input name=&quot;email&quot; id=&quot;email&quot; type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Email...&quot; /&gt;
         &lt;/div&gt;
         &lt;div class=&quot;form-group&quot;&gt;
             &lt;label for=&quot;password&quot;&gt;Password:&lt;/label&gt;
             &lt;input name=&quot;password&quot; id=&quot;password&quot; id=&quot;password&quot; type=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;Password...&quot; /&gt;
         &lt;/div&gt;
         &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;Login&lt;/button&gt;
         &lt;button type=&quot;button&quot; class=&quot;btn btn-default&quot;&gt;Cancel&lt;/button&gt;
     &lt;/form&gt;
 &lt;/div&gt;
</code></pre>
<ul>
<li>This form is using Bootstrap for the styling with the form-group, form-control btn, and btn-* css classes.</li>
<li>The autocomplete=&quot;off&quot; and novalidate directives for the form tag tell the browser to turn off that built-in functionality so that we can do our validation with Angular.</li>
</ul>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="add-submit-method">Add Submit Method</h3>
<p>In order to submit the form we need to tell Angular that that login form is an ngForm and use the ngSubmit event to tell Angular what to do when the form submit button is clicked.</p>
<h4 class="exercise-start">
    <b>Exercise</b>:  Add login function
</h4>

<ol>
<li><p>In the login.component.html file on the <code>&lt;form&gt;</code> tag add the following attributes.  </p>
<pre><code class="lang-html"> #loginForm=&quot;ngForm&quot; (ngSubmit)=&quot;login(loginForm.value)&quot;
</code></pre>
</li>
<li><p>On the email field we need to add an attribute tell Angular to implement a 1 way binding of the field.  We use the <code>(ngModel)</code> attribute to tell Angular what field in the form values we want to the data to be bound to.</p>
<pre><code class="lang-html"> (ngModel)=&quot;email&quot;
</code></pre>
</li>
<li><p>On the password field we are going to do the same thing that we just did to the email field.  </p>
<pre><code class="lang-html"> (ngModel)=&quot;password&quot;
</code></pre>
</li>
</ol>
<p>Next we need to implement the login function in the component.</p>
<ol>
<li>Open the login.component.ts file</li>
<li><p>Inside of the LoginComponent class, add the login function below.  For now we are just going to output the form values to the console. </p>
<pre><code class="lang-TypeScript"> login(formValues) {
     console.log(formValues);
 }
</code></pre>
</li>
<li><p>In your browser, while viewing the login form at <a href="http://localhost:4200/login">http://localhost:4200/login</a> open the developer tools and click the console tab so that you can see the console output.    </p>
</li>
<li><p>Now enter a value into the email and password fields and click the submit button.  You will see output similar to the below image where I entered the email of email@gmail.com and password of 123456</p>
<p> <img src="images/login-submit-console.png" alt="login console output"></p>
</li>
</ol>
<p>At this point we are ready to wire up the login form to actually </p>
<div class="exercise-end"></div>


<h3 id="required-validation">Required Validation</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Add Required Validation
</h4>


<p>For both the email and password fields they are required.  While we could check them in the component TypeScript code, Angular has built in validation by adding the <code>required</code> attribute to each of the inputs.</p>
<ol>
<li>Open the login.component.html</li>
<li><p>Add the <code>required</code> attribute to the email input field like so</p>
<pre><code class="lang-html"> &lt;input required (ngModel)=&quot;email&quot; name=&quot;email&quot; id=&quot;email&quot;  type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Email...&quot; /&gt;
</code></pre>
</li>
<li><p>Add the <code>required</code> attribute to the password input field</p>
<pre><code class="lang-html"> &lt;input required (ngModel)=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; id=&quot;password&quot; type=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;Password...&quot; /&gt;
</code></pre>
</li>
</ol>
<p>Next we want to display a message to the user when they have invalid entries in the form fields</p>
<ol>
<li><p>For the email field, inside of the form-group div tag and after the input field add the following code.  This code will show when the required errors triggers.  To trigger the error message, click on the email field and then click on the password field.</p>
<pre><code class="lang-TypeScript"> &lt;div *ngIf=&quot;email.errors &amp;&amp; (email.dirty || email.touched)&quot; class=&quot;alert alert-danger&quot;&gt;
     &lt;div [hidden]=&quot;!email.errors.required&quot;&gt;
     Email is required
     &lt;/div&gt;
 &lt;/div&gt;
</code></pre>
</li>
<li><p>In order to refer to the email field by name when checking errors, we need to add the <code>#email=&quot;ngModel&quot;</code> attribute to the email input field to tell Angular to create a variable for the control and make the value the ngModel value for the email field.  </p>
<pre><code class="lang-html"> &lt;input #email=&quot;ngModel&quot; required (ngModel)=&quot;email&quot; name=&quot;email&quot; id=&quot;email&quot; type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Email...&quot; /&gt;
</code></pre>
</li>
<li><p>For the password field, inside of the form-group div tag and after the input field add the following code.  This code will show when the required errors triggers.  To trigger the error message, click on the password field and then click on the email field.</p>
<pre><code class="lang-TypeScript"> &lt;div *ngIf=&quot;password.errors &amp;&amp; (password.dirty || password.touched)&quot; class=&quot;alert alert-danger&quot;&gt;
     &lt;div [hidden]=&quot;!password.errors.required&quot;&gt;
     Password is required
     &lt;/div&gt;
 &lt;/div&gt;
</code></pre>
</li>
<li><p>Just like the email field, we need to add the <code>#password=&quot;ngModel&quot;</code> attribute to the input control to name the field</p>
<pre><code class="lang-html"> &lt;input #password=&quot;ngModel&quot; required (ngModel)=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; id=&quot;password&quot; type=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;Password...&quot; /&gt;
</code></pre>
</li>
</ol>
<p>The last thing we want to do is to disable the login button until the form is valid.</p>
<ol>
<li><p>Find the submit button and add the following attribute to it to disable the button when the login form is invalid</p>
<pre><code class="lang-html"> &lt;button type=&quot;submit&quot;  [disabled]=&quot;loginForm.invalid&quot; class=&quot;btn btn-primary&quot;&gt;Login&lt;/button&gt;
</code></pre>
</li>
<li><p>Now we are ready to test our required validation.  </p>
<ul>
<li>Trigger email by clicking on the field and then clicking off the field with it still being blank or type something in the field and then erase it</li>
<li><p>Trigger the password field the same way</p>
<p><img src="images/login-required-validation.png" alt="required validation"></p>
</li>
</ul>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="email-validation">Email  Validation</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Add Email Validation
</h4>

<p>With the Angular 4 release, they added an email validator.  To add the validator to our email field, we just need to add an <code>email</code> attribute like we did for the <code>required</code> attribute.</p>
<pre><code class="lang-html">&lt;input email #email=&quot;ngModel&quot; required (ngModel)=&quot;email&quot; name=&quot;email&quot; id=&quot;email&quot; type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Email...&quot; /&gt;
</code></pre>
<p>Next we need to add a message like we did for the required validator for when the email validation triggers on an invalid email.  Add the following code below the required message but within the <code>&lt;div&gt;</code> that checks if there are errors.</p>
<pre><code class="lang-html">&lt;div [hidden]=&quot;!email.errors.email&quot;&gt;
    Must be an email address
&lt;/div&gt;
</code></pre>
<p>Now we are ready to test the email validation.  </p>
<ul>
<li><p>The validation will trigger if you input text into the email field that is not a valid email address.</p>
<p>  <img src="images/login-email-validation.png" alt="email validation"></p>
</li>
<li><p>The validation will also trigger at the same time as required </p>
<p>  <img src="images/login-email-required-validation.png" alt="required validation"></p>
</li>
</ul>
<p>Test</p>
<div class="exercise-end"></div>

<h3 id="disable-login-button">Disable Login Button</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Disable Login Button Until Valid
</h4>

<p>The last thing we want to do is to disable the login button until the form is valid.</p>
<ol>
<li><p>Find the submit button and add the following attribute to it to disable the button when the login form is invalid</p>
<pre><code class="lang-html"> &lt;button type=&quot;submit&quot;  [disabled]=&quot;loginForm.invalid&quot; class=&quot;btn btn-primary&quot;&gt;Login&lt;/button&gt;
</code></pre>
</li>
<li><p>Now when either field is invalid the login button will be disabled and a lighter share of blue</p>
<p> <img src="images/login-submit-disabled.png" alt="required validation"></p>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="implement-login-service">Implement Login Service</h3>
<p>Now that we have our form done, we are going to implement our login service.</p>
<h4 class="exercise-start">
    <b>Exercise</b>:  Generate Service
</h4>

<ol>
<li>Within VS Code, open up the integrated terminal (ctrl+`) or view menu and then &quot;Integrated Terminal&quot;</li>
<li><p>Run the ng generate command below to create the Authorization service.  I like to store my services under a shared\services folder.</p>
<pre><code class="lang-bash"> ng generate service shared/service/auth
</code></pre>
</li>
<li><p>The generate command will create 2 files: </p>
<p> <img src="images/login-service-generate.png" alt="output of generate"></p>
<ul>
<li>spec file (test)</li>
<li>typescript (service)</li>
</ul>
</li>
</ol>
<p>You will also notice that there is a warning that the service has not been provided. This means that we need to open up the module that we want to use the service in and add it to the providers list.</p>
<ol>
<li>Open src\app\app.module.ts</li>
<li><p>Import the AuthService</p>
<pre><code class="lang-TypeScript"> import { AuthService } from &#39;./shared/services/auth.service&#39;;
</code></pre>
</li>
<li><p>Find the @NgModule providers list and add the AuthService</p>
<pre><code class="lang-TypeScript">   providers: [AuthService],
</code></pre>
</li>
<li><p>Now the AuthService is available to the AppModule and we can use it in our LoginComponent</p>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Create Class
</h4>

<p>In the AuthService, In order to hold our user data and get type checking we need to create a TypeScript class with an email and id field.  We are going to leave the password field out of the class as we do not want to store this in memory at all.  </p>
<ol>
<li>Within VS Code, open up the integrated terminal (ctrl+`) or view menu and then &quot;Integrated Terminal&quot;</li>
<li><p>Run the ng generate command below to create the Authorization service.  I like to store my services under a shared\services folder.</p>
<pre><code class="lang-bash"> ng generate class shared/classes/User
</code></pre>
</li>
<li><p>The generate command will create 2 files: </p>
<p> <img src="images/user-generate.png" alt="output of generate"></p>
<ul>
<li>user.ts </li>
</ul>
</li>
<li><p>Open the src\app\shared\classes\User.ts file</p>
</li>
<li><p>Add email, id, createdAt, and updatedAt variables that of type script.  The createdAt and updatedAt are automatically added by the API.</p>
<pre><code class="lang-TypeScript"> email: string;
 id: string;
 createdAt: Date;
 updatedAt: Date;
</code></pre>
</li>
<li><p>Add a constructor that requires an email and make an id field optional (hint: the <code>?</code> make the parameter optional)</p>
<pre><code class="lang-TypeScript"> constructor(email: string, id?: string, createdAt?: Date, updatedAt?: Date){
     this.email = email;
     this.id = id;
     if (createdAt) this.createdAt = createdAt;
     if (updatedAt) this.updatedAt = updatedAt;
 }
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>


<h4 class="exercise-start">
    <b>Exercise</b>: Implement Auth Service Login Function
</h4>

<p>Now that we have our API server up and running, it is time to create our Auth service login function that call the API.</p>
<ol>
<li>Open the src\shared\services\auth.service.ts file</li>
<li><p>Import the following so that we can make our HTTP calls and get a response back.  </p>
<pre><code class="lang-TypeScript"> import { Http, Response, RequestOptions } from &#39;@angular/http&#39;;
 import { Observable } from &#39;rxjs/Rx&#39;;
</code></pre>
</li>
<li><p>In order to use the HTTP module, we need to inject it into our constructor</p>
<pre><code class="lang-TypeScript"> constructor(private http: Http) {
 }
</code></pre>
</li>
<li><p>We also want to create a public variable within the AuthClass to hold the output from the API call </p>
<pre><code class="lang-TypeScript"> public currentUser: User;
</code></pre>
</li>
<li><p>For the API that we are using (SailsJS based), it requires that we set the HTTP option to allow credentials so that the session cookie can be passed back and forth, else it will always think you haven&#39;t logged in.  </p>
<pre><code class="lang-TypeScript"> private options = new RequestOptions({ withCredentials: true });
</code></pre>
 <div class="alert alert-info" role="alert">You will need to pass in this.options as the last parameter for all of our http calls.</div>
</li>
<li><p>Next we need to create our login function within the AuthService class that will call our API</p>
<pre><code class="lang-TypeScript"> login(email: string, password: string): Observable&lt;boolean | Response&gt; {
     let loginInfo = { &quot;email&quot;: email, &quot;password&quot;: password };
     return this.http.put(&quot;https://dj-sails-todo.azurewebsites.net/user&quot;, loginInfo, this.options)
         .do((res: Response) =&gt; {
             if (res){
                 this.currentUser = &lt;User&gt;res.json();
             }
         })
         .catch(error =&gt; {
             console.log(&#39;login error&#39;, error)
             return Observable.of(false);
         });
 }
</code></pre>
 <div class="alert alert-info" role="alert">Since we have to pass the password to the API to validate the login, make sure you do not use your real passwords as we are communicating in development over a non-secure http connection so anyone can easily capture your email and password combo for the todo API.  In production, you would want use an SSL certificate.  As well for development, typically you would have the API locally but since this is an Angular workshop and not an API workshop, a remote API was provided for you.</div>

</li>
</ol>
<div class="exercise-end"></div>


<h4 class="exercise-start">
    <b>Exercise</b>: Call AuthService from LoginComponent
</h4>

<p>Now that we have our AuthService completed, we need to call it from our LoginComponent.  If we get a user back we will redirect the user to the home page</p>
<ol>
<li>Open the src\login\login.component.ts file</li>
<li><p>Import the AuthService so that we can make our HTTP calls and get a response back.  </p>
<pre><code class="lang-TypeScript"> import { AuthService } from &#39;../shared/services/auth.service&#39;;
 import { Router } from &#39;@angular/router&#39;;
</code></pre>
</li>
<li><p>In order to use the AuthService and Router, we need to inject it into our constructor</p>
<pre><code class="lang-TypeScript">constructor(private authService: AuthService, private router: Router) { }
</code></pre>
</li>
<li><p>Next we need to update our login function to call the AuthService and redirect if it finds the user.</p>
<pre><code class="lang-TypeScript">   login(formValues) {
 this.authService.login(formValues.email, formValues.password)
   .subscribe(result =&gt; {
     if (!this.authService.currentUser) {
       console.log(&#39;user not found&#39;);
     } else {
       this.router.navigate([&#39;/&#39;]);
     }
   });
 }
</code></pre>
</li>
<li><p>Navigate to <a href="http://localhost:4200/login">http://localhost:4200/login</a> .</p>
<ul>
<li>If you enter an email of foo@foo.com with a password 123456 you should be redirected to the home page</li>
<li>If you enter a bogus email or password, you will see a &quot;user not found&quot; message in the browser developer tools console.</li>
</ul>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>:  Show Invalid Login Message
</h4>

<p>Up to this point, we have been using the console to output when the login failed but we can not expect the user to have the dev tools console open.  Instead we need to show to the user when there is an error.</p>
<ol>
<li>Open the login.component.ts file</li>
<li><p>Create a new variable inside of the LoginComponent class called invalidLogin, is of type boolean and the default value is false.</p>
<pre><code class="lang-TypeScript"> invalidLogin: boolean = false;
</code></pre>
</li>
<li><p>Now in the login method replace the console.log line and set the invalidLogin variable to true.  Make sure in the else statement that you set the invalidLogin to false.</p>
<pre><code class="lang-TypeScript"> this.invalidLogin = true;
</code></pre>
<ul>
<li>We have to use this. to access the variable due to scoping.  </li>
</ul>
</li>
</ol>
<p>Now we are ready to implement the UI to show the error message.  </p>
<ol>
<li>Open the login.component.html file</li>
<li>We want to put our message after the cancel button but inside the <code>&lt;/form&gt;</code> tag</li>
<li><p>Add the following alert message</p>
<pre><code class="lang-html"> &lt;div *ngIf=&quot;loginInvalid&quot; class=&quot;alert alert-danger&quot;&gt;
     Invalid Login
 &lt;/div&gt;
</code></pre>
<div class="exercise-end"></div>
</li>
</ol>

				</div>
				<hr>

				<div class="chapter">
					<h2 id="reactive-forms">Reactive Forms</h2>
<h3 id="overview">Overview</h3>
<p>In the previous chapter, we took a look at template based forms.  In this chapter will will take a look at reactive based forms.</p>
<p>Reactive forms allow you to define the form fields and validation in the component instead of the template.  You can easily test the form fields and validation logic.  You can also dynamically build the form and validation in the component.</p>
<p>We are going to build the form to enter our Todo items using Reactive forms.</p>
<h3 id="goals">Goals</h3>
<ul>
<li>Understand reactive forms</li>
<li>Create a reactive form </li>
<li>Implement input validation</li>
<li>Submit form values to a service</li>
</ul>
<h3 id="create-todo-component">Create Todo Component</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Create Todo Component 
</h4>

<ol>
<li>Within VS Code, open up the integrated terminal (ctrl+`) or view menu and then &quot;Integrated Terminal&quot;</li>
<li><p>Run the ng generate command below to create the todo component</p>
<pre><code class="lang-bash"> ng generate component todo
</code></pre>
</li>
<li><p>The generate command will create 4 files: </p>
<p> <img src="images/todo-generate.png" alt="output of generate"></p>
<ul>
<li>scss (styles)</li>
<li>html (view)</li>
<li>spec file (test)</li>
<li>component (controller)</li>
<li>add reference to the component in the app.module.ts file.</li>
</ul>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="add-route">Add Route</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Todo Routing 
</h4>

<p>Before we can view our todo component, we need to tell Angular how to route to the page</p>
<ol>
<li>Open the src\app\app-routing.module.ts file</li>
<li><p>Add the Import statement for the todo component on line 3</p>
<pre><code class="lang-TypeScript"> import { TodoComponent } from &#39;./todo/todo.component&#39;;
</code></pre>
</li>
<li><p>Add the TodoComponent to the home page route as specified by the <code>path: &#39;&#39;</code> </p>
<pre><code class="lang-TypeScript"> {
     path: &#39;&#39;,
     children: [],
     component: TodoComponent
 }
</code></pre>
 <div class="alert alert-info" role="alert"><strong>Note:</strong> This will cause the TodoComponent to load into the <code>&lt;router-outlet&gt;&lt;/router-outlet&gt;</code> in the src\app\app.component.html.  The router-outlet tag is how Angular knows where to put the rendered content of the routed componente.</div>


</li>
</ol>
<ol>
<li><p>The todo page should be able to be displayed if you navigate to <a href="http://http://localhost:4200/">http://http://localhost:4200/</a></p>
<p> <img src="images/todo-initial-view.png" alt="todo initial view"></p>
</li>
</ol>
<div class="exercise-end"></div>


<h3 id="create-form">Create Form</h3>
<p>Next we are going to create the form without any validation logic at all.  Our form will have 1 input field for the todo item and an add button.</p>
<h4 class="exercise-start">
    <b>Exercise</b>: Import ReactiveFormsModule
</h4>

<p>With reactive forms, we are going to setup the form in your components TypeScript file.  </p>
<p>We need to import the ReactiveFormsModule into our AppModule before we can use it.</p>
<ol>
<li>Open the src\app\app.module.ts </li>
<li><p>Add ReactiveFormsModule to the @angular/forms import so that it looks like </p>
<pre><code class="lang-TypeScript"> import { FormsModule, ReactiveFormsModule } from &#39;@angular/forms&#39;;
</code></pre>
</li>
<li><p>In the @NgModule imports you need to add ReactiveFormsModule to the list</p>
<pre><code class="lang-TypeScript"> imports: [
     BrowserModule,
     FormsModule,
     ReactiveFormsModule,
     HttpModule,
     AppRoutingModule
 ],
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Form setup
</h4>

<p>Now we are ready to add all of the functionality to the component for the UI to interface with. For the todo component it is the src\app\todo\todo.component.ts file.  We need to add the Form.</p>
<ol>
<li>Open the todo\todo.component.ts file</li>
<li><p>We need to import a few items  </p>
<pre><code class="lang-TypeScript"> import { FormGroup, FormBuilder } from &#39;@angular/forms&#39;;
</code></pre>
</li>
<li><p>In the TodoComponent constructor we need to inject FormBuilder and configure the addForm.</p>
<pre><code class="lang-TypeScript"> constructor(private formBuilder: FormBuilder) {}
</code></pre>
<ul>
<li>This creates a form with a form control that is named item and has a default value of blank.</li>
</ul>
</li>
</ol>
<p>We need to implement an OnInit lifecycle event to configure the Form Builder.    </p>
<div class="alert alert-info" role="alert">
The OnInit lifecycle event will run before the component has rendered.<br></div>

<ol>
<li><p>In the todo.component.ts file, we need to import OnInit for @angular/core</p>
<pre><code class="lang-TypeScript"> import { Component, OnInit } from &#39;@angular/core&#39;;
</code></pre>
</li>
<li><p>Then in order to use the OnInit event, we need to add an implements OnInit to the class definition</p>
<pre><code class="lang-TypeScript"> export Class Todocomponent implements OnInit {
</code></pre>
</li>
<li><p>Last, we need to create the ngOnInit function in the TodoComponent class</p>
<pre><code class="lang-TypeScript"> ngOnInit(): void {

 }
</code></pre>
</li>
<li><p>Inside of the ngOnInit function, we need to build the add form</p>
<pre><code class="lang-TypeScript"> this.addForm = this.formBuilder.group({
     &#39;item&#39;: &#39;&#39;
 });
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>:  Creating the Todo UI 
</h4>

<p>We are now ready to create our UI. </p>
<ol>
<li>Open src\app\todo\todo.component.html </li>
<li><p>Replace the existing html with:</p>
<pre><code class="lang-html"> &lt;div class=&quot;container&quot;&gt;
     &lt;div class=&quot;page-header&quot;&gt;
         &lt;h1 align=&quot;center&quot;&gt;Todo List&lt;/h1&gt;
     &lt;/div&gt;
     &lt;form role=&quot;form&quot; [formGroup]=&quot;addForm&quot; class=&quot;text-center&quot;&gt;
         &lt;div class=&quot;form-group row&quot;&gt;
             &lt;div class=&quot;col-sm-10&quot;&gt;
                 &lt;input type=&quot;text&quot; class=&quot;form-control form-control-lg&quot; formControlName=&quot;item&quot; placeholder=&quot;Todo!&quot;&gt;
             &lt;/div&gt;
             &lt;div class=&quot;col-sm-2&quot;&gt;
                 &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary btn-lg btn-block&quot;&gt;Add&lt;/button&gt;
             &lt;/div&gt;
         &lt;/div&gt;
     &lt;/form&gt;
     &lt;br&gt;Dirty: {{ addForm.dirty }}
     &lt;br&gt;Touched: {{ addForm.touched }}
     &lt;br&gt;Valid: {{ addForm.valid }}
     &lt;br&gt;Errors: {{ addForm.get(&#39;item&#39;).errors | json }}
     &lt;br&gt;Value: {{ addForm.value | json }}

 &lt;/div&gt;
</code></pre>
<ul>
<li>The [formGroup] takes care of binding the addForm that we declared in the todo.component.ts file to the form.</li>
<li>This form is using Bootstrap for the styling with the form-group, form-control, btn, and btn* css classes.</li>
<li>The output at the bottom under the form, is so that you can see the state of the form, form fields values and the errors for the item field.</li>
</ul>
</li>
</ol>
<div class="exercise-end"></div>



<h3 id="add-submit-method">Add Submit Method</h3>
<p>In order to submit the form we need to add an <code>(ngSubmit)=&quot;&quot;</code></p>
<h4 class="exercise-start">
    <b>Exercise</b>:  Add ngSubmit
</h4>

<ol>
<li><p>In the src\app\todo\todo.component.html file and on the <code>&lt;form&gt;</code> tag add the <code>(ngSubmit)=&quot;&quot;</code> attribute</p>
<pre><code class="lang-html"> (ngSubmit)=&quot;save()&quot;
</code></pre>
</li>
<li><p>Open the src\app\todo\todo.component.ts file </p>
</li>
<li><p>Add the save function</p>
<pre><code class="lang-TypeScript"> save() : void {
     console.log(&#39;form values: &#39;, this.addForm.value);
 }
</code></pre>
<div class="alert alert-info" role="alert">If you completed the previous chapter on Template Forms, you will notice that we did not setup any ngModel tags or pass in the form to the save method.  With Reactive Forms, the formGroup provides the data binding for us.</div>

</li>
</ol>
<div class="exercise-end"></div>


<h3 id="validators">Validators</h3>
<p>Right now we do not have any validation being done on the form.  To setup validation, we need to modify our formBuilder item field setup.</p>
<h4 class="exercise-start">
    <b>Exercise</b>:  Add Validators for required and min length
</h4>

<ol>
<li>Open the src\app\todo\todo.component.ts file</li>
<li><p>Add the Validators import to @angular/forms import</p>
<pre><code class="lang-TypeScript"> import { FormGroup, FormBuilder, Validators } from &#39;@angular/forms&#39;;
</code></pre>
</li>
<li><p>In the constructor Modify the item field setting by turning the value into an array and adding an array of validators as the 2nd argument.  We are going to use the required and min length validators.</p>
<pre><code class="lang-TypeScript"> &#39;item&#39;: [&#39;&#39;, [Validators.required, Validators.minLength(3)]]
</code></pre>
</li>
</ol>
<p>Next we need to output the error messages.  For now, we are going to do it in the html but later we will make it more generic and add it to the component file instead.</p>
<ol>
<li><p>After the closing form tag in the todo.component.html file add the following </p>
<pre><code class="lang-html"> &lt;div class=&quot;alert alert-danger&quot;&gt;
   &lt;span *ngIf=&quot;formErrorMessage&quot;&gt;{{ formErrorMessage }}&lt;/span&gt;
   &lt;div *ngIf=&quot;addForm.get(&#39;item&#39;).errors&quot;&gt;
     &lt;span *ngIf=&quot;addForm.get(&#39;item&#39;).errors.required&quot;&gt;
       Item is required
     &lt;/span&gt;
     &lt;span *ngIf=&quot;addForm.get(&#39;item&#39;).errors.minlength&quot;&gt;
       Item must be 3 characters
     &lt;/span&gt;
   &lt;/div&gt;
 &lt;/div&gt;
</code></pre>
</li>
<li><p>If you go to <a href="http://localhost:4200/">http://localhost:4200/</a> you should now see that it displays a message when the input field is less than 3 characters or is blank.</p>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="easier-validation-messages">Easier Validation Messages</h3>
<p>We are going to setup a watcher to run when the item input field changes.  This will allow us to examine any errors and output the correct message from within the component instead of having all of the logic within the html code.</p>
<h4 class="exercise-start">
    <b>Exercise</b>:  Watching for Changes
</h4>

<ol>
<li>Open the src\app\todo\todo.component.ts file</li>
<li><p>In the ngOnInit function after the addForm setup, we need to get a reference to the item input field.  We can do this by using the get function of the form.</p>
<pre><code class="lang-TypeScript"> const itemControl = this.addForm.get(&#39;item&#39;);
</code></pre>
</li>
<li><p>Next we need to tell Angular to watch for value changes on the field</p>
<pre><code class="lang-TypeScript"> itemControl.valueChanges.subscribe(value =&gt; this.setMessage(itemControl));
</code></pre>
</li>
<li><p>Then we need to create the setMessage function that will examine the item control and any errors if has with validation.</p>
<pre><code class="lang-TypeScript"> setMessage(c: AbstractControl): void {
     this.formErrorMessage = &#39;&#39;;
     if ((c.touched || c.dirty) &amp;&amp; c.errors){
         this.formErrorMessage = Object.keys(c.errors).map(key =&gt; this.validationMessages[key]).join(&#39; &#39;);
     }
 }
</code></pre>
</li>
<li><p>In order for the setMessage function to work, we need to add a variable to the class called formErrorMessage that is of type script</p>
<pre><code class="lang-TypeScript"> formErrorMessage: string;
</code></pre>
</li>
<li><p>We also need to add a json object called validationMessages that will hold that message to display when a validator is invalid.  We need to have 2 messages, required and minlength.</p>
<pre><code class="lang-TypeScript"> private validationMessages = {
     required: &#39;Todo item is required&#39;,
     minlength: &#39;Todo item much be at least 3 characters
 }
</code></pre>
</li>
</ol>
<p>The last thing we need to do is up the UI to display the form error messages.    </p>
<ol>
<li>Open the todo.component.html file</li>
<li><p>Replace the validation messages that you added in the previous section with the one below.</p>
<pre><code class="lang-html"> &lt;div *ngIf=&quot;formErrorMessage&quot; class=&quot;alert alert-danger&quot;&gt;
   {{ formErrorMessage }}
 &lt;/div&gt;
</code></pre>
<div class="alert alert-info" role="alert">No longer do we have any logic in the html to find the validation controls to check status or what message to even display.</div>

</li>
</ol>
<div class="exercise-end"></div>


<h4 class="exercise-start">
    <b>Exercise</b>: Add Border On Invalid
</h4>

<p>You can also add a border around the Bootstrap form-group by adding the has-danger css class when the formErrorMessage has a value.</p>
<ol>
<li>Open the todo.component.html file</li>
<li><p>To the form-group div tag, add an ]ngClass]` attribute that checks for formErrorMessage and adds the has-danger when there is a value.</p>
<pre><code class="lang-html"> [ngClass]=&quot;{&#39;has-danger&#39;: formErrorMessage}&quot;
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="wait-before-validation-messages">Wait Before Validation Messages</h3>
<p>You might have notice after implementing the previous logic to check the field values in the TypeScript file, that the validation errors are immediately shown which can be annoying to users while they type.  Instead it would be better to wait for a given amount of time after the last keystroke before checking.  This is called debounce.  </p>
<p>Angular makes it very easy to implement what they call debounce to wait for the user to stop typing before running validation on our item input field.</p>
<h4 class="exercise-start">
    <b>Exercise</b>:  Implement Debounce
</h4>

<ol>
<li>Open todo.component.ts file</li>
<li><p>Import the rxjs debounceTime</p>
<pre><code class="lang-TypeScript"> import &#39;rxjs/add/operator/debounceTime&#39;;
</code></pre>
</li>
<li><p>On the line that you added the <code>itemControl.valueChanges.subscribe</code> add the <code>debounceTime</code> statement between valueChanges and subscribe like so</p>
<pre><code class="lang-TypeScript"> itemControl.valueChanges.debounceTime(1000).subscribe(value =&gt; this.setMessage(itemControl));
</code></pre>
</li>
<li><p>Now if you test the UI at <a href="http://localhost:4200">http://localhost:4200</a>, it will wait 1 second after the last keystroke before checking the input field validation.  You can change the time it waits by increasing or decreasing the value that is passed into the debounceTime function.</p>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="saving-todo-items">Saving Todo Items</h3>
<p>We are at the point, where we are ready to create a service to save the todo item.  Right now, we are just output the add form values to the console.</p>
<h4 class="exercise-start">
    <b>Exercise</b>: Class to Hold Todo item
</h4>

<p>Since TypeScript is a strongly typed language it is best practice to create a class to hold our Todo items.  This way we can get the type support for the different fields.</p>
<ol>
<li>Within VS Code, open up the integrated terminal (ctrl+`) or view menu and then &quot;Integrated Terminal&quot;</li>
<li><p>Run the ng generate command below to create the todo component</p>
<pre><code class="lang-bash"> ng generate class shared/classes/Todo
</code></pre>
</li>
<li><p>This will create 1 files: </p>
<p> <img src="images/todo-generate-class.png" alt="generate output"></p>
<ul>
<li>todo.ts</li>
</ul>
</li>
<li><p>Open src/app/shared/classes/todo</p>
</li>
<li><p>Add 4 fields to the Todo class</p>
<ul>
<li>id:string -&gt; id number of the todo item</li>
<li>item:string -&gt; the todo item text</li>
<li>createdAt:Date -&gt; The date added</li>
<li>updatedAt: Date -&gt; The date last updated</li>
<li>completed:boolean -&gt; completion state</li>
<li><p>user -&gt; id of the user that created the todo item</p>
<pre><code class="lang-TypeScript">id: string;
item: string;
completed: boolean;
createdAt: Date;
updatedAt: Date;
user: string;
</code></pre>
</li>
</ul>
</li>
<li><p>Add a constructor to initialize the fields.  Item will required while id, completed and createdAt will be optional. The optional fields must be after all of the required fields.  Having the value populated in the constructor will also make it easier to test later on.</p>
<pre><code class="lang-TypeScript"> constructor(
     item: string, 
     id?: string,
     completed?: boolean,
     createdAt?: Date,
     updatedAt?: Date) {
     id = id ? id : &#39;&#39;;
     this.item = item;
     this.completed = completed ? completed: false;
     this.createdAt = createdAt ? createdAt: new Date();
     this.updatedAt = updatedAt ? updatedAt: new Date();
 }
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>:  Create Todo Service
</h4>

<ol>
<li>Within VS Code, open up the integrated terminal (ctrl+`) or view menu and then &quot;Integrated Terminal&quot;</li>
<li><p>Run the ng generate command below to create the todo component</p>
<pre><code class="lang-bash"> ng generate service shared/services/Todo
</code></pre>
</li>
<li><p>This will create 2 files:  </p>
<p> <img src="images/todo-service-generate.png" alt="generate output"></p>
<ul>
<li>todo.service.ts</li>
<li>todo.service.spec.ts</li>
</ul>
</li>
</ol>
<p>You will also notice that there is a warning that the service has not been provided. This means that we need to open up the module that we want to use the service in and add it to the providers list.</p>
<ol>
<li>Open src\app\app.module.ts</li>
<li><p>Import the TodoService</p>
<pre><code class="lang-TypeScript"> import { TodoService } from &#39;./shared/services/todo.service&#39;;
</code></pre>
</li>
<li><p>Find the @NgModule providers list and add the TodoService</p>
<pre><code class="lang-TypeScript">   providers: [AuthService, TodoService],
</code></pre>
</li>
<li><p>Now the TodoService is available to the AppModule and we can use it in our TodoComponent</p>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Add Todo Service Save
</h4>

<p>Now that we have the Todo service file created, we need to add our save method that calls our json-server api server and then update the Todo component to call the service.</p>
<ol>
<li>Open the src\app\shared\services\todo.service.ts file</li>
<li><p>Import the following so that we can make our HTTP calls and get a response back.  </p>
<pre><code class="lang-TypeScript"> import { Http, Response, RequestOptions } from &#39;@angular/http&#39;;
 import { Observable } from &#39;rxjs/Rx&#39;;
</code></pre>
</li>
<li><p>Import the todo class </p>
<pre><code class="lang-TypeScript"> import { Todo } from &#39;../classes/todo&#39;;
</code></pre>
</li>
<li><p>In order to use the HTTP module, we need to inject it into our constructor</p>
<pre><code class="lang-TypeScript"> constructor(private http: Http) { }
</code></pre>
</li>
<li><p>For the API that we are using (SailsJS based), it requires that we set the HTTP option to allow credentials so that the session cookie can be passed back and forth, else it will always think you haven&#39;t logged in.  </p>
<pre><code class="lang-TypeScript"> private options = new RequestOptions({ withCredentials: true });
</code></pre>
 <div class="alert alert-info" role="alert">You will need to pass in this.options as the last parameter for all of our http calls.</div>


</li>
</ol>
<ol>
<li><p>Next we need to create our login function within the AuthService class that will call our API</p>
<pre><code class="lang-TypeScript"> save(item: string): Observable&lt;Todo&gt; {
     let url = &#39;https://dj-sails-todo.azurewebsites.net/todo&#39;;
     var todo  = new Todo(item);
     return this.http.post(url, todo, this.options)
     .map((res: Response) =&gt; {
         return &lt;Todo&gt;res.json();
     })
     .catch(error =&gt; {
         console.log(&#39;save error&#39;, error)
         return error;
     });
 }
</code></pre>
</li>
</ol>
<p>Now we need to call the TodoService save function in the TodoComponent</p>
<ol>
<li>Open the src\app\todo\todo.component.ts file</li>
<li><p>Import the TodoService</p>
<pre><code class="lang-TypeScript"> import &#39;TodoService&#39; from &#39;../shared/services/todo.service&#39;;
</code></pre>
</li>
<li><p>Add the TodoService to the constructor</p>
<pre><code class="lang-TypeScript"> constructor(private formBuilder: FormBuilder, private todoService: TodoService) { }
</code></pre>
</li>
<li><p>Update our save method to call the <code>TodoService.save</code> function and output the result to the console</p>
<pre><code class="lang-TypeScript"> save(): void {
     this.todoService.save(this.addForm.value.item)
     .subscribe(result =&gt; {
         console.log(&#39;save result&#39;, result);
     },
     error =&gt; {
         this.errorMessage = &lt;any&gt;error;
     });
 }
</code></pre>
</li>
<li><p>We now need to create the errorMessage variable that is of type string in the Todocomponent class</p>
<pre><code class="lang-TypeScript"> errorMessage: string;
</code></pre>
</li>
<li><p>Now we need to add an alert section to our todo.component.html to display the error message.  After the <code>&lt;/form&gt;</code> tag, add the following code</p>
<pre><code class="lang-TypeScript"> &lt;div *ngIf=&quot;errorMessage&quot; class=&quot;alert alert-danger&quot; role=&quot;alert&quot;&gt;
   {{ errorMessage }}
 &lt;/div&gt;
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="displaying-items">Displaying Items</h3>
<p>Now that we have the ability to save our items, we need to be able to display the current list with options to complete or delete a todo item.</p>
<h4 class="exercise-start">
    <b>Exercise</b>: Html to Display Items
</h4>

<ol>
<li>Open the src\app\todo\todo.component.html</li>
<li>Since we have our form working, remove the form status troubleshooting entries.</li>
<li><p>After the error message alert, add the following html to display the list of todo items</p>
<pre><code class="lang-html"> &lt;div class=&quot;row&quot; *ngFor=&quot;let todoItem of todoList&quot;&gt;
   &lt;div class=&quot;col-12 done-{{todoItem.completed}}&quot;&gt;
     {{todoItem.item}} &lt;small&gt;created: {{todoItem.createdAt | date:&#39;short&#39;}}&lt;/small&gt;
   &lt;/div&gt;
 &lt;/div&gt;
</code></pre>
<ul>
<li>the *ngFor will loop through all of the items in the todoList variable that we will be creating next.  </li>
<li>For the date, we are using the built-in date pipe to convert it to a short date that strips out the time part of the date</li>
<li>We are also setup to have a different style when an item is completed.  We will add the styling in a bit.    </li>
</ul>
</li>
</ol>
<div class="exercise-end"></div>



<h4 class="exercise-start">
    <b>Exercise</b>: Add TodoService Get All 
</h4>

<p>Next we need to add a getAll function to our TodoService that does an http get to our API to get all of the todo items.</p>
<ol>
<li>Open the src\app\shared\services\todo.service.ts file</li>
<li><p>Add the following function to do an http get call against our API</p>
<pre><code class="lang-TypeScript"> getAll(): Observable&lt;Array&lt;Todo&gt;&gt;{
 let url = &quot;https://dj-sails-todo.azurewebsites.net/todo&quot;;
 return this.http.get(url, this.options)
   .map((res: Response) =&gt; {
     return &lt;Array&lt;Todo&gt;&gt;res.json();
   })
   .catch(error =&gt; {
     console.log(&#39;get error&#39;, error);
     return error;
   });
 }
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Call TodoService Get All from Component 
</h4>

<p>Now that we have the TodoService.getAll function created, we are ready to create the getTodoListAll function that will call the TodoService.  We will wire up the getTodoListAll function to be called in ngOnInit so that it will populate the todo list on component load.</p>
<ol>
<li>Open the src\app\todo\todo.component.ts file</li>
<li><p>Import the todo class </p>
<pre><code class="lang-TypeScript"> import { Todo } from &#39;../shared/classes/todo&#39;;
</code></pre>
</li>
<li><p>Create a variable in the TodoComponent class called todoList that is an array of Todo and intialize to an empty array</p>
<pre><code class="lang-TypeScript"> todoList: Array&lt;Todo&gt; = [];
</code></pre>
</li>
<li><p>Create the getTodoListAll function that will return void, call the TodoService.getAll function and set a todoList variable at the Todocomponent class level.</p>
<pre><code class="lang-TypeScript"> getTodoListAll(): void {
 this.todoService.getAll()
   .subscribe(
   data =&gt; {
     this.todoList = data;
   },
   error =&gt; {
     this.errorMessage = &lt;any&gt;error;
   }
   );
 }
</code></pre>
</li>
<li><p>Now we are ready to call the getTodoListAll function in ngOnInit</p>
<pre><code class="lang-TypeScript"> this.getTodoListAll();
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Updating Todo list on save 
</h4>

<p>Now that we have the Todo list being stored in the todoList variable, when we save a new todo item, we can add it to the todoList array and the todo list will automatically update with the change.</p>
<ol>
<li><p>In the todo.component.ts file, we need to update the save function to push the save result into the todoList array.</p>
<pre><code class="lang-TypeScript"> this.todoList.push(result);
</code></pre>
</li>
<li><p>When you add a new todo item, the list will now update itself.</p>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Complete Todo Item
</h4>

<p>Right now the todo list is just a read only view but we need to be able to complete the todo items.  We need to add an icon to the todo list that will toggle the completed status and save the new todo item state to the API.</p>
<ol>
<li>Open the src\app\shared\services\todo.service.ts file</li>
<li><p>We are going to create an update method that will take in a Todo item and make an  http put call to our API to update the one record with the new completion state.</p>
<pre><code class="lang-TypeScript"> updateTodo(todo: Todo): Observable&lt;Todo&gt; {
     let url = `https://dj-sails-todo.azurewebsites.net/todo/${todo.id}`;

     return this.http.put(url, todo, this.options)
     .map((res: Response) =&gt; &lt;Todo&gt;res.json())
     .catch(error =&gt; {
         console.log(&#39;update error&#39;, error);
         return error;
     });
 }
</code></pre>
<ul>
<li>For the url we are using string interpolation to create the url.  This is done with the &#96;&#96; tags and the ${}</li>
</ul>
</li>
</ol>
<p>Now we need to call the updateTodo service function in our component.</p>
<ol>
<li>Open the todo.component.ts file</li>
<li><p>Create the completeTodo method that the UI will call </p>
<pre><code class="lang-TypeScript"> completeTodo(todo: Todo): void {
     todo.completed = !todo.completed;
     this.todoService.updateTodo(todo)
     .subscribe(
         data =&gt; {
             // do nothing
         },
         error =&gt; {
             todo.completed = !todo.completed;
             this.errorMessage = &lt;any&gt;error;
             console.log(&#39;complete error&#39;, this.errorMessage);
         });
 }
</code></pre>
<ul>
<li>For now we are not going to do anything with the returned result.  In the future you could call a sort function or update an open todo item counter.</li>
</ul>
</li>
</ol>
<p>The last thing we need to do it do update the UI to have a checkbox icon that will be clicked on to toggle the completion state.</p>
<ol>
<li>Open the todo.component.html file</li>
<li><p>Inside the ngFor loop, above the existing div add the following icon that uses the Font Awesome library for the icon and is set to take up 1 column of space</p>
<pre><code class="lang-html">   &lt;div class=&quot;col-1&quot; (click)=&quot;completeTodo(todoItem)&quot;&gt;&lt;i [className]=&quot;todoItem.completed ? &#39;fa fa-check-square-o&#39; : &#39;fa fa-square-o&#39;&quot;&gt;&lt;/i&gt;&lt;/div&gt;
</code></pre>
<ul>
<li>We are passing in the todo item that we are wanting to update to the completedTodo function.  This will pass in the whole object so we have access to all of the fields.</li>
<li>We are updating the icon used based on the completed field state.  If completed we are using fa-check-square-o.  If not completed, we are using fa-square-o</li>
</ul>
</li>
<li><p>With Bootstrap it is a 12 column grid, so we need to reduce the size of the existing div from col-12 to col-11</p>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Delete Todo Item
</h4>

<p>In addition to being able to complete a todo item, we also need to be able to delete one.  We need to add an icon to the todo list that will call a delete function in the component and delete the todo item from our database.</p>
<ol>
<li>Open the src\app\shared\services\todo.service.ts file</li>
<li><p>We are going to create delete method</p>
<pre><code class="lang-TypeScript"> deleteTodo(todo: Todo): Observable&lt;Response&gt; {
     let url = `https://dj-sails-todo.azurewebsites.net/todo/${todo.id}`;
     return this.http.delete(url, this.options)
     .catch(error =&gt; {
         console.log(&#39;delete error&#39;, error);
         return error;
     });
 }
</code></pre>
<ul>
<li>We are passing in the todo item that we are wanting to update to the completedTodo function.  This will pass in the whole object so we have access to all of the fields.</li>
<li>We are not doing any kind of mapping of the return results since there is none.  It is either successful or not.</li>
</ul>
</li>
</ol>
<p>Next we need to create the deleteTodo item function in the component that will call the TodoService.delete function</p>
<ol>
<li>Open the todo.component.ts file</li>
<li><p>Create the deleteTodo function that takes in a todo item and calls the TodoService.delete function</p>
<pre><code class="lang-TypeScript"> deleteTodo(todo: Todo): void {
     this.todoService.deleteTodo(todo)
     .subscribe(
     data =&gt; {
         let index = this.todoList.indexOf(todo);
         this.todoList.splice(index, 1);
     },
     error =&gt; {
         todo.completed = !todo.completed;
         this.errorMessage = &lt;any&gt;error;
         console.log(&#39;complete error&#39;, this.errorMessage);
     });
 }
</code></pre>
<ul>
<li>In the results of the deleteTodo service, we are going to remove the todo item from the displayed list since it no longer exist.  We could have also call the TodoService.getAll function but since we already have all of the items and the items are specific to a single user, there is no need to make the extra database call.</li>
</ul>
</li>
</ol>
<p>The last thing that we need to do is to add the delete icon to the todo list.</p>
<ol>
<li>Open the todo.component.html file</li>
<li><p>Add a div after the div displays the todo item text but still inside of the ngFor div.  This new div will hold the delete icon which we will use the fa-trash icon and when clicked it will call the deleteTodo function.  The icon is going to take up 1 column of space in the grid.</p>
<pre><code class="lang-TypeScript"> &lt;div class=&quot;col-1&quot; (click)=&quot;deleteTodo(todoItem)&quot;&gt;&lt;i class=&quot;fa fa-trash&quot;&gt;&lt;/i&gt;&lt;/div&gt;
</code></pre>
</li>
<li><p>Since the Bootstrap grid is 12 columns wide, we need to reduce the text div from col-11 to col-10.</p>
</li>
</ol>
<div class="alert alert-info" role="alert">The reason that we used the Bootstrap grid is so that everything wrapped correctly with longer todo items and when the screen was smaller.  The Bootstrap grid provides this functionality automatically for you.</div>

<p>The html for the display of the Todo list should look like the following:</p>
<pre><code class="lang-html">&lt;div class=&quot;row todo&quot; *ngFor=&quot;let todoItem of todoList&quot;&gt;
    &lt;div class=&quot;col-1&quot; (click)=&quot;completeTodo(todoItem)&quot;&gt;&lt;i [className]=&quot;todoItem.completed ? &#39;fa fa-check-square-o&#39; : &#39;fa fa-square-o&#39;&quot;&gt;&lt;/i&gt;&lt;/div&gt;

    &lt;div class=&quot;col-10 done-{{todoItem.completed}}&quot;&gt;{{todoItem.item}} &lt;br /&gt;&lt;small&gt;created: {{todoItem.createdAt | date:&#39;short&#39;}}&lt;/small&gt;&lt;/div&gt;

    &lt;div class=&quot;col-1&quot; (click)=&quot;deleteTodo(todoItem)&quot;&gt;&lt;i class=&quot;fa fa-trash&quot;&gt;&lt;/i&gt;&lt;/div&gt;
&lt;/div&gt;
</code></pre>
<div class="exercise-end"></div>

<h3 id="adding-style">Adding Style</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Making the Todo list look nicer
</h4>

<p>Right now the UI looks decent but with a few tweaks it could look much better.  </p>
<p><img src="images/todo-unstyled.png" alt="todo unstyled"></p>
<p>If we added some padding around each row, a bottom border, made the date smaller and gray, increased the size of each icon and made the completed items gray with a strike-through, the UI would pop.</p>
<p>The first thing we need to do is add in our styles to the Todo component.  Since these styles are strictly for the Todo component we are going to add them into the todo.component.scss instead of the app&#39;s style.scss file.</p>
<ol>
<li>Open the src\app\todo\todo.component.scss </li>
<li><p>Add the following contents to the file.  To ensure we are following our branding, we are importing our scss color variables.</p>
<pre><code class="lang-scss"> @import &quot;../../assets/bootstrap/variables&quot;;
 div.todo {
     width: 100%;
     padding-bottom: .2em;
     padding-top: .2em;
     border-bottom: 1px solid $gray-light;
     font-size: 1.4em;

     small {
         font-size: .7em;
         color: $gray-light;
     }

     i {
         width: 40px;
         padding-right: 10px;
         vertical-align: middle
     }

     .done-true {
         text-decoration: line-through;
         color: $gray-light;
     }
 }
</code></pre>
</li>
<li><p>Now if you view the UI it should look like below.  </p>
<p> <img src="images/todo-styled-final.png" alt="unstyled ui"></p>
</li>
</ol>
<div class="exercise-end"></div>



<h3 id="review">Review</h3>
<p>We did a lot in this chapter implementing our Reactive form</p>
<ol>
<li>Created a form using the FormBuilder</li>
<li>Added validation to the FormBuilder</li>
<li>Created a value change observable to set the field validation message</li>
<li>Added debounce to wait until the user is done typing before checking the field validation</li>
<li>Show the list of todo list with icons to complete and delete todo items</li>
<li><p>You used several Angular directives to implement functionality in the UI:</p>
<ul>
<li>*ngIf - replacement for ng-if.  Only show section if condition is true</li>
<li>*ngFor - replacement for ng-repeat.  Loop through a list and do something</li>
<li>[(ngModel)] - two-way data binding</li>
<li>(click) - binds to the click event</li>
<li>[className] - replacement for ngClass and set the css class for the element</li>
<li>(ngModelChange) - runs method when the [(ngModel)] value changes</li>
<li>[hidden] - hides the element when condition is true </li>
<li>(ngSubmit) - submits a form </li>
<li>[formGroup] - used for reactive forms.  basically dynamic forms that you can control in the controller</li>
<li>[disabled] - set the element to disabled when condition is true</li>
</ul>
</li>
</ol>
<div class="exercise-end"></div>

				</div>
				<hr>

				<div class="chapter">
					<h2 id="environment-configuration">Environment Configuration</h2>
<h3 id="overview">Overview</h3>
<p>One of the requirements that you commonly have it to be able to change configurations for your application based on the environment it is running in.  A common configuration is to change the API url between development and production.  In order to change the configurations for different environments, Angular uses configurations files that are stored in the src\environments folder.  </p>
<h3 id="goals">Goals</h3>
<ul>
<li>Learn how to change configurations per environment</li>
<li>Implement environment configurations</li>
</ul>
<h3 id="default-configuration">Default Configuration</h3>
<p>The src\environments\environment.ts file is the default configurations if no environment is specified when running <code>ng serve</code></p>
<p>In the environment.ts we need to add the environmentName and apiBaseUrl values.  The apiBaseUrl is how to get to your service layer, if you have one.  I have created an API for us to use at <a href="https://dj-sails-todo.azurewebsites.net">https://dj-sails-todo.azurewebsites.net</a></p>
<h4 class="exercise-start">
    <b>Exercise</b>: Setup Default Configuration
</h4>

<ol>
<li>Open the src\environments\environment.ts file</li>
<li><p>Add the environmentName and apiBaseUrl values.  </p>
<pre><code class="lang-TypeScript"> export const environment = {
     production: false,
     environmentName: &#39;Development&#39;,
     apiBaseUrl: &#39;https://dj-sails-todo.azurewebsites.net&#39;
 };
</code></pre>
</li>
<li><p>Go to the terminal that is running the <code>ng serve</code> command and do a ctrl+c to stop it.</p>
</li>
<li><p>Run the <code>ng serve</code> command again.</p>
<pre><code class="lang-bash"> ng serve
</code></pre>
</li>
<li><p>Everything should still start as normal.  You will not see any changes at this point since nothing is using those settings.  We will use them in a bit in our footer and our services.</p>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="local-development">Local Development</h3>
<p>The other environment that is typically created is for local development on your machine.  For this tutorial the environment.ts and local.ts have the same values but once you go from development to production they will differ.   </p>
<h4 class="exercise-start">
    <b>Exercise</b>: Create Local Configuration
</h4>

<ol>
<li>Create the file src\environments\environment.local.ts file</li>
<li><p>Add the following to the environment.local.ts file</p>
<pre><code class="lang-TypeScript"> export const environment = {
 production: false,
 environmentName: &#39;Local&#39;,
 apiBaseUrl: &#39;https://dj-sails-todo.azurewebsites.net&#39;
 };
</code></pre>
</li>
<li><p>Open the .angular-cli.json that is in the root of the project.  </p>
</li>
<li><p>Find the apps\environments section and add the local configuration to the at the top of the list of environments</p>
<pre><code class="lang-json"> &quot;local&quot;: &quot;environments/environment.local.ts&quot;,
</code></pre>
</li>
<li><p>If you want to run the local configuration we need to pass in the environment command line argument.  The environment argument value is the name of the environment name in the angular-cli.json file.  Note that you can only have 1 ng serve running at a time.    </p>
<pre><code class="lang-bash"> ng serve -e local
</code></pre>
</li>
<li><p>If the Angular compile was successful, you will now be using the local environment configuration. You will not see any changes at this point since nothing is using those settings.  We will use them in the next exercise in our footer.</p>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Add Environment Name to Footer
</h4>

<ol>
<li><p>Open the src\app\shared\footer\footer.component.ts file and import the environment into the file on line 2 right below the Angular core import</p>
<pre><code class="lang-TypeScript"> import { environment } from &#39;../../../environments/environment&#39;;
</code></pre>
</li>
<li><p>Inside the FooterComponent class we to add a variable to capture the environment name that Angular is running in</p>
<pre><code class="lang-TypeScript"> public env = environment.environmentName;
</code></pre>
</li>
<li><p>Open the src\app\shared\footer\footer.component.html and replace the contents with</p>
<pre><code> &lt;footer&gt;
     &lt;div class=&quot;pull-left&quot;&gt;
         &amp;copy;Angular WS
     &lt;/div&gt;
     &lt;div class=&quot;pull-right&quot;&gt;
         env: {{ env }} 
     &lt;/div&gt;      
 &lt;/footer&gt;
</code></pre></li>
<li><p>If you view the web page you should see the footer </p>
<p><img src="images/footer-with-env.png" alt="App Works with Footer"></p>
<div class="alert alert-warning" role="alert">
    Notice that the env:Local in the footer is coming from the environment.local.ts file.  If you stop <code>ng serve</code> and run it without using the -e argument, the env value will change to Development

    <img src="images/footer-with-env-dev.png" alt="footer development env">

</div>

</li>
</ol>
<div class="exercise-end"></div>    

<h4 class="exercise-start">
    <b>Exercise</b>: Updating Services With Environment Url
</h4>

<p>Now that we have the API url in the environments file, we should update the TodoService and AuthService to get the base url from the environments file instead of having it hard coded.  While we are at it, we should also create a variable in the services to hold the base url so that we don&#39;t have it all over the place in the services.</p>
<ol>
<li>Open the src\app\shared\services\todo.service.ts file</li>
<li><p>Import the environment file</p>
<pre><code class="lang-TypeScript"> import { environment } from &#39;../../../environments/environment&#39;;
</code></pre>
</li>
<li><p>Create a private variable called url inside the TodoService class that gets the apiBaseUrl from the environment file and append on the /todo</p>
<pre><code class="lang-TypeScript">   private url: string = `${environment.apiBaseUrl}/todo`;
</code></pre>
</li>
<li><p>For the save and getAll functions update the hard coded url to use the class level url variable.  You will need to change url to this.url in order to access the class level variable.</p>
</li>
<li><p>For the updateTodo and deleteTodo we need to replace the hard coded url with the class level url variable.  Since we are already using string interpolation to create the string, we need to replace the hard coded value with <code>${this.url}</code></p>
<pre><code class="lang-TypeScript"> let url = `${this.url}/${todo.id}`;
</code></pre>
</li>
<li><p>Everything should still work to list, insert, update and delete todo items as before but now the url is no longer hard coded and can easily be changed as you move to different environments.</p>
</li>
<li><p>Now repeat the same process with the AuthService</p>
</li>
</ol>
<div class="exercise-end"></div>

				</div>

				<hr>
				<div class="chapter">
					<h2 id="locking-down-routes">Locking Down Routes</h2>
<h3 id="overview">Overview</h3>
<p>A very common requirement with applications is to do authentication or authorization check before allowing a user to perform action.  Common usage cases are: </p>
<ul>
<li>Role checks such as admin before allowing the user into the admin section of the application</li>
<li>Is the user logged in check before allowing them into the page the pulls or updates data </li>
<li>Is the user logged out before allowing them to create an account</li>
</ul>
<p>In this chapter we are going to implement a check for if the user is logged in.</p>
<h3 id="goals">Goals</h3>
<ul>
<li>Understand how to protect a route</li>
<li>Understand how to use a guard</li>
</ul>
<h3 id="create-guard">Create Guard</h3>
<h4 class="exercise-start">
  <b>Exercise</b>: Check If User Is Logged In
</h4>

<ol>
<li><p>Open terminal and generate the guard </p>
<pre><code class="lang-bash">ng generate guard shared/guards/IsLoggedIn
</code></pre>
<p><img src="images/isloggedin-generate.png" alt="generate output"></p>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
  <b>Exercise</b>: Add Guard to Module
</h4>

<p>Before you can use the guard, you need to add it to the providers list in the module</p>
<ol>
<li>Open the app.module.ts </li>
<li><p>Import the AdminGuard</p>
<pre><code class="lang-TypeScript">import { IsLoggedInGuard } from &#39;./shared/guards/is-logged-in.guard&#39;;
</code></pre>
</li>
<li><p>Add the AdminGuard to the providers list</p>
<pre><code class="lang-TypeScript">providers: [AuthService, TodoService, IsLoggedInGuard],
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="add-logic-to-guard">Add Logic to Guard</h3>
<h4 class="exercise-start">
  <b>Exercise</b>: Add Logic
</h4>

<p>We need to do add logic in the AuthService to verify that the currentUser variable has a value.  </p>
<ol>
<li>Open the src\app\shared\services\auth.service.ts file</li>
<li><p>Add an isAuthenticated function to the AuthService that checks the API to make sure that the user is still logged in</p>
<pre><code class="lang-TypeScript">isAuthenticated(): Observable&lt;boolean&gt; {
 return this.http.get(this.url + &#39;/identity&#39;, this.options)
   .map((res: Response) =&gt; {
     if (res) {
       return Observable.of(true);
     }

     return Observable.of(false);
   })
   .catch((error: Response) =&gt; {
     if (error.status !== 403) {
       console.log(&#39;isAuthenticated error&#39;, error)
       this.clearUser();
     }

     return Observable.of(false);
   });
}
</code></pre>
<p>Next we need to add logic to the guard&#39;s canActivate function to call the AuthService.isAuthenticated function </p>
</li>
<li><p>Open src\app\shared\guards\is-logged-in.guard.ts </p>
</li>
<li><p>Import the AuthService</p>
<pre><code class="lang-TypeScript">import { AuthService } from &#39;../services/auth.service&#39;;
</code></pre>
</li>
<li><p>Import the Router as part of the @angular/route import statement</p>
</li>
</ol>
<ol>
<li><p>create a constructor and inject the AuthService and Router </p>
<pre><code class="lang-TypeScript">constructor(private authService: AuthService, private router: Router) { }
</code></pre>
</li>
<li><p>In the canActivate function we want to add the following logic instead of just returning true.  This code will call the AuthService.isAuthenticated function and then return true or false depending on if the user is logged in or not.  If the user is not logged in or there is an error validating if they are logged in then we will navigate them to the login route</p>
<pre><code class="lang-TypeScript">canActivate(  next: ActivatedRouteSnapshot,
 state: RouterStateSnapshot): Observable&lt;boolean&gt; | Promise&lt;boolean&gt; | boolean {
 let isLoggedIn = new Observable&lt;boolean&gt;(observer =&gt; {
 this.authService.isAuthenticated()
   .subscribe((res: boolean) =&gt; {
   if (res) {
     observer.next(true);
     observer.complete();
   } else {
     this.router.navigate([&#39;/login&#39;]);
     observer.next(false);
     observer.complete();
   }
   }, error =&gt; {
     observer.next(false);
     observer.complete();
   });
 });

 return isLoggedIn;
}
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>


<h3 id="add-guard-to-route">Add Guard to Route</h3>
<p>In order to use the Guard we need to add it to the route.  Each route has a canActivate attribute that takes an array of guards as the 3rd parameter.</p>
<h4 class="exercise-start">
  <b>Exercise</b>: Add Guard to Route
</h4>

<ol>
<li>Open the app-routing.module.ts file</li>
<li><p>Import the IsLoggedInGuard</p>
<pre><code class="lang-TypeScript">import { IsLoggedInGuard} from &#39;./shared/guards/is-logged-in.guard&#39;
</code></pre>
</li>
<li><p>To the default route, add the canActivate attribute with the value being an array that contains the IsLoggedInGuard</p>
<pre><code class="lang-TypeScript">, canActivate: [IsLoggedInGuard]
</code></pre>
</li>
<li><p>Now stop ng serve and restart it.  When you try to go to <a href="http://localhost:4200">http://localhost:4200</a> it will redirect you to the login page since you are not logged in yet.  </p>
</li>
</ol>
<div class="exercise-end"></div>



<div class="exercise-end"></div>

<h3 id="create-create-account-component">Create Create Account Component</h3>
<p>Up to this point, we have only been able to login to an existing account.  Now we are going to quickly create the signup page.  It is a template based form, just like the login form that was completed in a previous chapter.</p>
<ol>
<li>Open src\app\shared\services\auth.service.ts</li>
<li>Add RequestOptions to the @angular/http import</li>
<li></li>
<li><p>Add the following method to allow an account to be created</p>
<pre><code class="lang-TypeScript">signup(email: string, password: string) {
 let loginInfo = { &quot;email&quot;: email, &quot;password&quot;: password };
 return this.http.post(this.url, loginInfo, this.options)
   .do((res: Response) =&gt; {
     if (res) {
       let currentUser: User = &lt;User&gt;res.json();
       this.setUser(new User(currentUser.email, currentUser.id));
     }
   })
   .catch(error =&gt; {
     console.log(&#39;signup error&#39;, error)
     return Observable.of(false);
   });
}
</code></pre>
<div class="alert alert-info" role="alert">REMINDER: Since we have to pass the password to the API in order to create the account and we are communicating over a non-secure channel, make sure you do not use your real passwords.  With the non-secure connection anyone can easily capture your email and password combo for the todo API.  In production, you would want use an SSL certificate.  As well for development, typically you would have the API locally but since this is an Angular workshop and not an API workshop, a remote API was provided for you.</div>


</li>
</ol>
<ol>
<li><p>Open terminal and run</p>
<pre><code class="lang-TypeScript">ng generate component signup
</code></pre>
</li>
<li><p>Open the app-routing.module.ts file</p>
</li>
<li><p>Add a new route to get to the signup page</p>
<pre><code class="lang-TypeScript">{ path: &#39;signup&#39;, component: SignupComponent},
</code></pre>
</li>
<li><p>Open the src\app\signup\signup.html file</p>
</li>
<li><p>Replace the contents with the following UI and template based form to allow a user to create an account</p>
<pre><code class="lang-html">&lt;h1&gt;Sign Up&lt;/h1&gt;
&lt;hr&gt;
&lt;div&gt;
 &lt;form #signupForm=&quot;ngForm&quot; (ngSubmit)=&quot;signup(signupForm.value)&quot; autocomplete=&quot;off&quot; novalidate&gt;
   &lt;div class=&quot;form-group&quot; &gt;
     &lt;label for=&quot;userName&quot;&gt;Email:&lt;/label&gt;
     &lt;em *ngIf=&quot;email?.invalid &amp;&amp; (email?.touched  || mouseoverLogin)&quot;&gt;Required&lt;/em&gt;

     &lt;input #email=&quot;ngModel&quot;  (ngModel)=&quot;email&quot; name=&quot;email&quot; id=&quot;email&quot; required email id=&quot;email&quot; type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Email...&quot; /&gt;
     &lt;div *ngIf=&quot;email.invalid &amp;&amp; (email.dirty || email.touched)&quot;
           class=&quot;alert alert-danger&quot;&gt;
           &lt;div [hidden]=&quot;!email.errors.required&quot;&gt;
             Email is required
           &lt;/div&gt;
       &lt;/div&gt;

   &lt;/div&gt;
   &lt;div class=&quot;form-group&quot; &gt;
     &lt;label for=&quot;password&quot;&gt;Password:&lt;/label&gt;
     &lt;em *ngIf=&quot;password?.invalid &amp;&amp; (password?.touched || mouseoverLogin)&quot;&gt;Required&lt;/em&gt;
     &lt;input #password=&quot;ngModel&quot; (ngModel)=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; required minlength=&quot;6&quot; id=&quot;password&quot; type=&quot;password&quot; class=&quot;form-control&quot;placeholder=&quot;Password...&quot; /&gt;
       &lt;div *ngIf=&quot;password.invalid &amp;&amp; (password.dirty || password.touched)&quot;
           class=&quot;alert alert-danger&quot;&gt;
           &lt;div [hidden]=&quot;!password.errors.required&quot;&gt;
             Password is required
           &lt;/div&gt;
           &lt;div [hidden]=&quot;!password.errors.minlength&quot;&gt;
             Password must be at least 6 characters long.
           &lt;/div&gt;
       &lt;/div&gt;
   &lt;/div&gt;

   &lt;span (mouseenter)=&quot;mouseoverLogin=true&quot; (mouseleave)=&quot;mouseoverLogin=false&quot;&gt;
     &lt;button type=&quot;submit&quot; [disabled]=&quot;signupForm.invalid&quot; class=&quot;btn btn-primary&quot;&gt;Sign Up&lt;/button&gt;
   &lt;/span&gt;
   &lt;button type=&quot;button&quot; (click)=&quot;cancel()&quot; class=&quot;btn btn-default&quot;&gt;Cancel&lt;/button&gt;
       &lt;span&gt;&lt;a [routerLink]=&quot;[&#39;/login&#39;]&quot;&gt;login to existing account&lt;/a&gt;&lt;/span&gt;

 &lt;/form&gt;
 &lt;br /&gt;
 &lt;div *ngIf=&quot;loginInvalid&quot; class=&quot;alert alert-danger&quot;&gt;Invalid Login Info&lt;/div&gt;
&lt;/div&gt;
</code></pre>
</li>
<li><p>Open the src\app\signup\signup.component.ts file</p>
</li>
<li><p>Add the following import statements</p>
<pre><code class="lang-TypeScript">import { AuthService } from &#39;../shared/services/auth.service&#39;;
import { Router } from &#39;@angular/router&#39;;
</code></pre>
</li>
<li><p>Add a constructor and inject the AuthService and Router</p>
<pre><code class="lang-TypeScript">constructor(private authService: AuthService, private router: Router) { }
</code></pre>
</li>
<li><p>Create a variable in the SignupComponent class called loginInvalid that is of type string</p>
<pre><code class="lang-TypeScript">loginInvalid: boolean = false;
</code></pre>
</li>
<li><p>Create the signup function with the following code</p>
<pre><code class="lang-TypeScript">signup(formValues) {
 this.authService.signup(formValues.email, formValues.password)
   .subscribe(result =&gt; {
     if (!result) {
       this.loginInvalid = true;
     } else {
       this.router.navigate([&#39;/&#39;]);
     }
   });
}
</code></pre>
</li>
<li><p>Open the login.component.html file</p>
</li>
<li><p>Next to the cancel button add the following HTML to give a link to the create page</p>
<pre><code class="lang-html">&lt;span&gt;&lt;a [routerLink]=&quot;[&#39;/signup&#39;]&quot;&gt;create account&lt;/a&gt;&lt;/span&gt;
</code></pre>
</li>
<li><p>You should now to be able to create accounts and navigate between the signup and login pages.  Once logged in or account created, you will be redirected to the home page and shown the todo items.</p>
</li>
</ol>

				</div>
				<hr>
				<div class="chapter">
					<h2 id="implementing-default-route">Implementing Default Route</h2>
<h3 id="overview">Overview</h3>
<p>We have not yet implemented a catch all route which will be the route that is used when Angular does not match any other configured routes.  .</p>
<p><img src="images/ng2/no-route-found.png" alt="no route found"></p>
<p>There are 2 ways to fix this.  </p>
<ol>
<li>Make the TodoComponent the default so that it will redirect the user to that page.  This is not as nice of a user experience since it does not alert the user that the url they were trying to go to does not exist.</li>
<li>Create a &quot;Not Found&quot; component and redirect the user to that component if none of the other routes match.  This is the preferred method.</li>
</ol>
<h3 id="goals">Goals</h3>
<ul>
<li>Understand how to deal with an unknown route</li>
</ul>
<h3 id="add-default-route">Add Default Route</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Adding Default Route 
</h4>

<div class="alert alert-danger" role="alert">
<strong>Note:</strong> Not the preferred method.<br></div>

<ol>
<li>Open the app.routing.ts file</li>
<li><p>Add an additional route to the Routes list with a ** for the path and set the component to TodoComponent.  This will tell Angular to use the TodoComponent when it can not determine the route</p>
<pre><code class="lang-TypeScript"> , { path: &#39;**&#39;, component: TodoComponent }
</code></pre>
 <div class="alert alert-warning">
 Make sure that you make the default route the last route.  Any routes below the ** route will be ignored.
 </div>

</li>
</ol>
<div class="exercise-end"></div>

<h3 id="create-not-found-component">Create Not Found Component</h3>
<h4 class="exercise-start">
    <b>Exercise</b>: Redirecting User to &quot;Not Found&quot; component
</h4>

<div class="alert alert-success" role="alert">
<strong>Note:</strong> This is the preferred method.<br></div>

<p>From a user experience perspective, it is a much experience to redirect the user to a &quot;not found&quot; page instead of redirecting them back to the home page.  Create the route not found page is just like we did with the todo component.    </p>
<ol>
<li><p>Run the Angular Cli generate command to create the notFound component</p>
<pre><code class="lang-bash"> ng generate component notFound
</code></pre>
</li>
<li><p>4 files are created just like when we created the TodoComponent earlier.  You will notice this time though that the Angular Cli put a dash between not and found.  It will automatically do that when it encounters an uppercase character.</p>
<p> <img src="images/ng2/notfound-generated.png" alt="not found generated file list"></p>
</li>
<li><p>In the src\app\app-routing.module.ts file, add an import statement for the NotFoundComponent </p>
<pre><code class="lang-TypeScript"> import { NotFoundComponent } from &#39;./not-found/not-found.component&#39;;
</code></pre>
</li>
<li><p>In the app-routing.module.ts file, change the ** route to use the NotFoundComponent</p>
<pre><code class="lang-TypeScript"> , { path: &#39;**&#39;, component: NotFoundComponent }
</code></pre>
</li>
<li><p>If you now try to navigate to <a href="http://localhost:4200/unknown">http://localhost:4200/unknown</a> you will be shown the NotFoundComponent </p>
<p> <img src="images/view-route-unknown.png" alt="Not Found View"></p>
</li>
</ol>

				</div>
				<hr>

				<div class="chapter">
					<h2 id="deploying">Deploying</h2>
<h3 id="overview">Overview</h3>
<p>Before deploy you will need to run an a build with the Angular CLI.  With the build you can tell it the environment to use and if it is a production build or not.  A production will minify everything.</p>
<h3 id="goals">Goals</h3>
<ul>
<li>Learn how to create a build that is ready to deploy.</li>
</ul>
<h3 id="non-production-build">Non-Production Build</h3>
<div class="alert alert-info" role="alert">
Note the build create a dist folder to hold the output.   This directory is removed before each build
</div>

<p>Select which type of build you want to run:  Non-Production or Production</p>
<h4 class="exercise-start">
  <b>Exercise</b>: Running Non-Production Build
</h4>

<p>Run the following command to run a build that uses the environment.ts file and is not a production build</p>
<pre><code class="lang-bash">ng build
</code></pre>
<div class="exercise-end"></div>

<h3 id="production-build">Production Build</h3>
<h4 class="exercise-start">
  <b>Exercise</b>: Running a Production Build
</h4>

<div class="alert alert-warning" role="alert">
Note that this will remove the dist directory before build.
</div>

<p>Run the following command to run a build that uses the environment.prod.ts file and is a production build.   The environment name must match the file name for it to be valid.</p>
<pre><code class="lang-bash">ng build --target=production --environment=prod
</code></pre>
<div class="exercise-end"></div>

				</div>
				<hr>

				<div class="chapter">
					<h2 id="bonus-additional-todo-features">Bonus: Additional Todo Features</h2>
<h3 id="overview">Overview</h3>
<h3 id="goals">Goals</h3>
<ul>
<li>Show how to implement additional usability features such as running open item count, sorting in the UI and resetting the form. </li>
</ul>
<h3 id="displaying-open-item-count">Displaying Open Item Count</h3>
<p>It would be nice to know how many todo items that the user has and display that in the UI.  You will need to make sure to update the open number when pulling, updating, and deleting todo items.</p>
<h4 class="exercise-start">
    <b>Exercise</b>: Calculating Open Items
</h4>

<ol>
<li>Open the src\app\todo\todo.component.ts file</li>
<li><p>Create a variable to hold the open count in the TodoCompoment class that is of type number</p>
<pre><code class="lang-TypeScript"> openItemCount: number = 0;
</code></pre>
</li>
<li><p>Add the following function to get the count of open todo items by using the filter function to look for items where the completed value is false.</p>
<pre><code class="lang-TypeScript"> calculateOpenItems(): void {
     this.openItemCount = this.todoList.filter(item =&gt; item.completed === false).length;
 }
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Updating Open Item Count on Fetch
</h4>

<ol>
<li><p>In the getTodoListAll function, add a call to the calculateOpenItems function after setting the todoList variable to data.  </p>
<pre><code class="lang-TypeScript"> getTodoListAll(): void {
     this.todoService.getAll()
     .subscribe(
     data =&gt; {
         this.todoList = data;
         this.calculateOpenItems();
     },
     error =&gt; {
         this.errorMessage = &lt;any&gt;error;
     });
 }
</code></pre>
</li>
</ol>
<div class="exercise-end"></div>


<h4 class="exercise-start">
    <b>Exercise</b>: Update Open Item Count on Add
</h4>

<ol>
<li><p>In the todo.component.ts file increment the openItemCount in the save function</p>
<pre><code class="lang-TypeScript"> save(): void {
     this.todoService.save(this.addForm.value.item)
         .subscribe(result =&gt; {
             console.log(&#39;save result&#39;, result);
             this.todoList.push(result);
             this.openItemCount++;
         },
         error =&gt; {
             this.errorMessage = &lt;any&gt;error;
         });
 }
</code></pre>
</li>
</ol>
<div class="alert alert-info" role="alert">Since we are just adding a new record and are not pulling a new todo list array from the service, we can just increment the openItemCount variable.</div>


<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Update Open Item on Complete 
</h4>

<p>When we toggle the completion status of a Todo item we also need to update the openItemCount value.</p>
<p>In the completeTodo, upon returning the data from the TodoService.updateTodo call, we need to update the openItemCount. To do this, we will call the calculateOpenItems function.</p>
<p>The reason that we did not just subtract from the openItemCount is that we are able to toggle completion status so sometime you will need to add and other times you will need to subtract.  Instead of having to create this logic, we can just call the calculateOpenItems function to do the work for us.</p>
<ol>
<li>In the todo.component.ts file, find the completeTodo function and add the call to calculateOpenItems in the returned data</li>
</ol>
<pre><code class="lang-TypeScript">completeTodo(todo: Todo): void {
    todo.completed = !todo.completed;
    this.todoService.updateTodo(todo)
        .subscribe(
        data =&gt; {
         this.calculateOpenItems();
        },
        error =&gt; {
            todo.completed = !todo.completed;
            this.errorMessage = &lt;any&gt;error;
            console.log(&#39;complete error&#39;, this.errorMessage);
        });
}
</code></pre>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Update Open Item on Delete
</h4>

<p>The last thing we need to do is to re-calculate the openItemCount when an item is deleted.  We don&#39;t just decrement since a user can delete a completed it and there is no sense in adding in additional logic since the calculateOpenItems already has the logic.</p>
<ol>
<li>In the todo.component.ts file, find the deleteTodo function and add the call to the calculateOpenItems function after removing the deleted item from the todoList.</li>
</ol>
<pre><code class="lang-TypeScript">deleteTodo(todo: Todo): void {
    this.todoService.deleteTodo(todo)
        .subscribe(
        data =&gt; {
            let index = this.todoList.indexOf(todo);
            this.todoList.splice(index, 1);
            this.calculateOpenItems();
        },
        error =&gt; {
            todo.completed = !todo.completed;
            this.errorMessage = &lt;any&gt;error;
            console.log(&#39;complete error&#39;, this.errorMessage);
        });
}
</code></pre>
<div class="exercise-end"></div>

<h4 class="exercise-start">
    <b>Exercise</b>: Add Open Item Count to UI
</h4>

<p>The last thing we need to do is add the open item count to the UI.  It should automatically update as items are added, updated, and deleted.</p>
<ol>
<li>Open the todo.component.html file</li>
<li><p>Inside of the page-header div after the &quot;Todo List&quot; title, add the following html</p>
<pre><code class="lang-html"> &lt;p class=&quot;lead&quot;&gt;You&#39;ve got &lt;em&gt;{{openItemCount}}&lt;/em&gt; things to do&lt;/p&gt;
</code></pre>
</li>
<li><p>The UI should now look like</p>
<p> <img src="images/todo-open-items.png" alt="open item count display">    </p>
</li>
</ol>
<div class="exercise-end"></div>

<h3 id="sort-in-the-ui">Sort in the UI</h3>
<p>Right now the data from the API comes back unsorted.  It is ordered based on the order that they were added.  Instead it would be much better if we sorted the todo items based on the text and completion status.  The completed items should be at the bottom.  As well the sort should be case insensitive.  </p>
<p>With ES6 and TypeScript we can use a map and reduce function to accomplish this task. </p>
<h4 class="exercise-start">
    <b>Exercise</b>: Sorting in the Client
</h4>

<ol>
<li>Open the todo.component.ts file</li>
<li><p>Add the following code to create a generic array sort function</p>
<pre><code class="lang-TypeScript"> fieldSorter(fields, ignoreCase) {
     return (a, b) =&gt; fields.map(o =&gt; {
         let dir = 1;
         if (o[0] === &#39;-&#39;) { dir = -1; o = o.substring(1); }
         if (ignoreCase === true &amp;&amp; typeof a[o] === &#39;string&#39; &amp;&amp; typeof b[o] === &#39;string&#39;) {
         a[0] = a[o].toLocaleLowerCase();
         b[o] = b[o].toLocaleLowerCase();
         }

         return a[o] &gt; b[o] ? dir : a[o] &lt; b[o] ? -(dir) : 0;
     }).reduce((p, n) =&gt; p ? p : n, 0);
 }
</code></pre>
<ul>
<li><p>We can even have it sort if needed in decending order by appending on a - sign to the field name.</p>
<div class="alert alert-info" role="alert">The fieldSorter function is generic and can be reused on any array sort call.</div>


</li>
</ul>
</li>
</ol>
<ol>
<li><p>Now that we have our generic sorting method, we can create a function to do the actual sorting that can be called in the save, completedTodo and deleteTodo functions</p>
<pre><code class="lang-TypeScript"> sortItems(): void {
     this.todoList.sort(this.fieldSorter([&#39;completed&#39;, &#39;name&#39;], true));
 }
</code></pre>
</li>
<li><p>The last thing we need to do is to call the sortItems function in the save, completeTodo and getTodoListAll functions.  Make sure to place the call after any updates to the todoList have occurred</p>
<pre><code> this.sortItems();
</code></pre><ul>
<li>We do not need to call the sort in the deleteTodo since the list will already be sorted and we are only removing a single item.</li>
</ul>
</li>
<li><p>Now when you use interact with the UI the list will stay sorted by name and complete state.  The sort is also case insensitive and the open items should be on the top of the list.</p>
<p> <img src="images/todo-sorted.png" alt="sorted output"></p>
</li>
</ol>
<div class="exercise-end"></div>


<h3 id="reset-form-after-save">Reset Form After Save</h3>
<p>Right now after you add a new todo item, the form does not clear out the input box.  Then when you go to clear it out, the required field validator will be fired.</p>
<p>Instead, we can clear out the field on a successful save call by adding a call to <code>this.addForm.reset();</code></p>
<pre><code class="lang-TypeScript">
</code></pre>

				</div>
				<hr>

				<div class="chapter">
					<h2 id="bonus-additional-login-features">Bonus: Additional Login Features</h2>
<p><strong>CHAPTER IS NOT COMPLETE</strong></p>
<h3 id="overview">Overview</h3>
<h3 id="goals">Goals</h3>
<h3 id="caching-user">Caching User</h3>
<p>Right now when you refresh the page the current user information in the AuthService is lost.  We can cache the data using cookies.  To implement the cookie storage we are going to use the ngx-cookie library.</p>
<h4 class="exercise-start">
  <b>Exercise</b>: Install ngx-cookie
</h4>

<ol>
<li><p>Open terminal and generate the guard </p>
<pre><code class="lang-bash">npm install --save ngx-cookie
</code></pre>
</li>
<li><p>Open src\app\app.module.ts</p>
</li>
<li><p>Import the ngx-cookie library</p>
<pre><code class="lang-TypeScript">
</code></pre>
</li>
<li><p>Add the ngx-cookie library to the @Ngmodule imports sections</p>
<pre><code class="lang-TypeScript"> imports: [
     BrowserModule,
     FormsModule,
     ReactiveFormsModule,
     HttpModule,
     AppRoutingModule,
     CookieModule.forRoot()
 ],
</code></pre>
</li>
<li><p>Open the auth.service.ts file</p>
</li>
<li><p>Add the following functions to get/set the cookie</p>
<pre><code class="lang-TypeScript"> getUser(): User {
     return &lt;User&gt;this.cookieService.getObject(this.cookieKey)
 }

 private setUser(value: User) {
     this.cookieService.putObject(this.cookieKey, value);
 }

 private clearUser() {
     this.cookieService.remove(this.cookieKey);
 }
</code></pre>
</li>
<li><p>In the login function, change the do statement that is setting the currentUser value to</p>
<pre><code class="lang-TypeScript"> if (res) {
       let currentUser: User = &lt;User&gt;res.json();
       this.setUser(new User(currentUser.email, currentUser.id));
 }
</code></pre>
</li>
<li><p>You can remote the class variable currentUser as it will no longer be used.</p>
</li>
</ol>
<h3 id="is-user-logged-out">Is User Logged Out</h3>
<p>Before being able to signup for an account, we need the user to be logged out first.</p>
<h3 id="logout-user">Logout User</h3>
<ol>
<li>open the auth.service.ts file</li>
<li><p>Add the logout function below that will call the API logout function and clear out the cookie</p>
<pre><code class="lang-TypeScript"> logout(): Observable&lt;boolean&gt; {
   return this.http.get(this.url + &#39;/logout&#39;, this.options)
     .map((res: Response) =&gt; {
       if (res.ok) {
         this.clearUser();
         return Observable.of(true);
       }

       return Observable.of(false);
     })
     .catch(error =&gt; this.handleError(error));
 }
</code></pre>
</li>
<li><p>Open the     </p>
</li>
</ol>

				</div>
				<hr>

				<div class="chapter">
					<h2 id="thank-you">Thank you</h2>
<p>I hope that you enjoyed going through this tutorial.  If you have any questions, please hit me up on twitter <a href="https://twitter.com/digitaldrummerj">@digitaldrummerj</a>.  </p>

				</div>
				<hr>
			</div>
		</div>
	</div>

	<script src="scripts/built.js"></script>

</body>

</html>
